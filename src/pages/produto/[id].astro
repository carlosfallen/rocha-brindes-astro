---
import Layout from "../../layouts/Layout.astro"
import ProductDetail from "../../components/products/ProductDetail.astro"

// ID vindo da URL
const id = Astro.params.id!

// Buscar produto individual na KV
const product = await import.meta.env.KV_PRODUCTS.get(`product:${id}`, "json")

if (!product) {
  return Astro.redirect("/produtos?erro=produto-nao-encontrado")
}
---

<Layout title={product.nome ?? "Produto"}>
  <ProductDetail product={product} />
</Layout>

---
import Layout from "../../layouts/Layout.astro"
import ProductDetail from "../../components/products/ProductDetail.astro"
import { doc, getDoc, collection, getDocs } from 'firebase/firestore'
import { db } from '../../core/lib/firebase'

export async function getStaticPaths() {
  const snap = await getDocs(collection(db, 'produtos'))
  return snap.docs.map(d => ({
    params: { id: d.id },
    props: { product: { id: d.id, ...d.data() } }
  }))
}

const { product } = Astro.props
---

<Layout title={product.nome ?? "Produto"}>
  <ProductDetail product={product} />
</Layout>

---
import { getCatalog } from "../../core/services/catalog"
import { optimizeUrl } from "../../shared/utils/image"

let products = []
let errorMessage = null

try {
  const data = await getCatalog(8)
  products = data.products
} catch (error) {
  console.error("Error loading new products:", error)
  errorMessage = "Não foi possível carregar as novidades no momento."
}
--- 

<section class="container mx-auto px-4 py-12">
  <h2 class="text-2xl font-bold mb-6 text-gray-900">
    Novidades
  </h2>

  {errorMessage && (
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
      <p class="text-yellow-800">{errorMessage}</p>
    </div>
  )}

  {!errorMessage && products.length === 0 && (
    <p class="text-gray-500">Nenhum produto novo foi encontrado.</p>
  )}

  <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    {products.map((product) => (
      <a href={`/produto/${product.id}`} class="group block">
        <div class="w-full aspect-square rounded-lg bg-gray-100 overflow-hidden shadow">
          <img
            src={optimizeUrl(product.imagem_url, "public")}
            alt={product.nome}
            class="w-full h-full object-cover group-hover:scale-105 transition-transform"
            loading="lazy"
          />
        </div>
        <h3 class="mt-2 font-semibold text-gray-800 group-hover:text-orange-500">
          {product.nome}
        </h3>
      </a>
    ))}
  </div>
</section>

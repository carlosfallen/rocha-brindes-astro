import{S as Re,p as pe,r as q,s as oe,a as Y,n as ie,i as ne,b as ge,t as Oe,d as Z,f as Pe,e as Ae,g as fe,h as Ce,j as De,u as Ue,c as e,F as le}from"./Providers.DwJZh4qX.js";import{r as l}from"./index.Ba-IbuDT.js";import{c as Se,q as ze,e as ue,b as j,f as Le,s as te,d as F,h as Te,u as ce,i as Ee,g as ke,j as Me,a as _e}from"./firebase.BWuIrDj8.js";import{c as V}from"./createLucideIcon.DozWMnKj.js";import{o as je}from"./image.BnuFfM80.js";var $e=class extends Re{constructor(t,a){super(),this.options=a,this.#a=t,this.#s=null,this.#r=pe(),this.bindMethods(),this.setOptions(a)}#a;#e=void 0;#p=void 0;#t=void 0;#i;#d;#r;#s;#g;#u;#m;#n;#l;#o;#h=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),be(this.#e,this.options)?this.#c():this.updateResult(),this.#x())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return de(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return de(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#N(),this.#e.removeObserver(this)}setOptions(t){const a=this.options,r=this.#e;if(this.options=this.#a.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof q(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#e.setOptions(this.options),a._defaulted&&!oe(this.options,a)&&this.#a.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const i=this.hasListeners();i&&ye(this.#e,r,this.options,a)&&this.#c(),this.updateResult(),i&&(this.#e!==r||q(this.options.enabled,this.#e)!==q(a.enabled,this.#e)||Y(this.options.staleTime,this.#e)!==Y(a.staleTime,this.#e))&&this.#f();const d=this.#b();i&&(this.#e!==r||q(this.options.enabled,this.#e)!==q(a.enabled,this.#e)||d!==this.#o)&&this.#y(d)}getOptimisticResult(t){const a=this.#a.getQueryCache().build(this.#a,t),r=this.createResult(a,t);return Fe(this,r)&&(this.#t=r,this.#d=this.options,this.#i=this.#e.state),r}getCurrentResult(){return this.#t}trackResult(t,a){return new Proxy(t,{get:(r,i)=>(this.trackProp(i),a?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#r.status==="pending"&&this.#r.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,i))})}trackProp(t){this.#h.add(t)}getCurrentQuery(){return this.#e}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const a=this.#a.defaultQueryOptions(t),r=this.#a.getQueryCache().build(this.#a,a);return r.fetch().then(()=>this.createResult(r,a))}fetch(t){return this.#c({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#t))}#c(t){this.#w();let a=this.#e.fetch(this.options,t);return t?.throwOnError||(a=a.catch(ie)),a}#f(){this.#v();const t=Y(this.options.staleTime,this.#e);if(ne||this.#t.isStale||!ge(t))return;const r=Oe(this.#t.dataUpdatedAt,t)+1;this.#n=Z.setTimeout(()=>{this.#t.isStale||this.updateResult()},r)}#b(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#y(t){this.#N(),this.#o=t,!(ne||q(this.options.enabled,this.#e)===!1||!ge(this.#o)||this.#o===0)&&(this.#l=Z.setInterval(()=>{(this.options.refetchIntervalInBackground||Pe.isFocused())&&this.#c()},this.#o))}#x(){this.#f(),this.#y(this.#b())}#v(){this.#n&&(Z.clearTimeout(this.#n),this.#n=void 0)}#N(){this.#l&&(Z.clearInterval(this.#l),this.#l=void 0)}createResult(t,a){const r=this.#e,i=this.options,d=this.#t,b=this.#i,u=this.#d,o=t!==r?t.state:this.#p,{state:x}=t;let m={...x},P=!1,h;if(a._optimisticResults){const g=this.hasListeners(),y=!g&&be(t,a),L=g&&ye(t,r,a,i);(y||L)&&(m={...m,...Ae(x.data,t.options)}),a._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:v,errorUpdatedAt:A,status:k}=m;h=m.data;let I=!1;if(a.placeholderData!==void 0&&h===void 0&&k==="pending"){let g;d?.isPlaceholderData&&a.placeholderData===u?.placeholderData?(g=d.data,I=!0):g=typeof a.placeholderData=="function"?a.placeholderData(this.#m?.state.data,this.#m):a.placeholderData,g!==void 0&&(k="success",h=fe(d?.data,g,a),P=!0)}if(a.select&&h!==void 0&&!I)if(d&&h===b?.data&&a.select===this.#g)h=this.#u;else try{this.#g=a.select,h=a.select(h),h=fe(d?.data,h,a),this.#u=h,this.#s=null}catch(g){this.#s=g}this.#s&&(v=this.#s,h=this.#u,A=Date.now(),k="error");const c=m.fetchStatus==="fetching",s=k==="pending",p=k==="error",C=s&&c,S=h!==void 0,R={status:k,fetchStatus:m.fetchStatus,isPending:s,isSuccess:k==="success",isError:p,isInitialLoading:C,isLoading:C,data:h,dataUpdatedAt:m.dataUpdatedAt,error:v,errorUpdatedAt:A,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>o.dataUpdateCount||m.errorUpdateCount>o.errorUpdateCount,isFetching:c,isRefetching:c&&!s,isLoadingError:p&&!S,isPaused:m.fetchStatus==="paused",isPlaceholderData:P,isRefetchError:p&&S,isStale:me(t,a),refetch:this.refetch,promise:this.#r,isEnabled:q(a.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const g=M=>{R.status==="error"?M.reject(R.error):R.data!==void 0&&M.resolve(R.data)},y=()=>{const M=this.#r=R.promise=pe();g(M)},L=this.#r;switch(L.status){case"pending":t.queryHash===r.queryHash&&g(L);break;case"fulfilled":(R.status==="error"||R.data!==L.value)&&y();break;case"rejected":(R.status!=="error"||R.error!==L.reason)&&y();break}}return R}updateResult(){const t=this.#t,a=this.createResult(this.#e,this.options);if(this.#i=this.#e.state,this.#d=this.options,this.#i.data!==void 0&&(this.#m=this.#e),oe(a,t))return;this.#t=a;const r=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,d=typeof i=="function"?i():i;if(d==="all"||!d&&!this.#h.size)return!0;const b=new Set(d??this.#h);return this.options.throwOnError&&b.add("error"),Object.keys(this.#t).some(u=>{const w=u;return this.#t[w]!==t[w]&&b.has(w)})};this.#C({listeners:r()})}#w(){const t=this.#a.getQueryCache().build(this.#a,this.options);if(t===this.#e)return;const a=this.#e;this.#e=t,this.#p=t.state,this.hasListeners()&&(a?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#x()}#C(t){Ce.batch(()=>{t.listeners&&this.listeners.forEach(a=>{a(this.#t)}),this.#a.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function qe(t,a){return q(a.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&a.retryOnMount===!1)}function be(t,a){return qe(t,a)||t.state.data!==void 0&&de(t,a,a.refetchOnMount)}function de(t,a,r){if(q(a.enabled,t)!==!1&&Y(a.staleTime,t)!=="static"){const i=typeof r=="function"?r(t):r;return i==="always"||i!==!1&&me(t,a)}return!1}function ye(t,a,r,i){return(t!==a||q(i.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&me(t,r)}function me(t,a){return q(a.enabled,t)!==!1&&t.isStaleByTime(Y(a.staleTime,t))}function Fe(t,a){return!oe(t.getCurrentResult(),a)}var Ie=l.createContext(!1),Qe=()=>l.useContext(Ie);Ie.Provider;function Ve(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Be=l.createContext(Ve()),We=()=>l.useContext(Be),He=(t,a)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(a.isReset()||(t.retryOnMount=!1))},Ge=t=>{l.useEffect(()=>{t.clearReset()},[t])},Ke=({result:t,errorResetBoundary:a,throwOnError:r,query:i,suspense:d})=>t.isError&&!a.isReset()&&!t.isFetching&&i&&(d&&t.data===void 0||De(r,[t.error,i])),Je=t=>{if(t.suspense){const r=d=>d==="static"?d:Math.max(d??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...d)=>r(i(...d)):r(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Xe=(t,a)=>t.isLoading&&t.isFetching&&!a,Ye=(t,a)=>t?.suspense&&a.isPending,xe=(t,a,r)=>a.fetchOptimistic(t).catch(()=>{r.clearReset()});function Ze(t,a,r){const i=Qe(),d=We(),b=Ue(),u=b.defaultQueryOptions(t);b.getDefaultOptions().queries?._experimental_beforeQuery?.(u),u._optimisticResults=i?"isRestoring":"optimistic",Je(u),He(u,d),Ge(d);const w=!b.getQueryCache().get(u.queryHash),[o]=l.useState(()=>new a(b,u)),x=o.getOptimisticResult(u),m=!i&&t.subscribed!==!1;if(l.useSyncExternalStore(l.useCallback(P=>{const h=m?o.subscribe(Ce.batchCalls(P)):ie;return o.updateResult(),h},[o,m]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),l.useEffect(()=>{o.setOptions(u)},[u,o]),Ye(u,x))throw xe(u,o,d);if(Ke({result:x,errorResetBoundary:d,throwOnError:u.throwOnError,query:b.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw x.error;return b.getDefaultOptions().queries?._experimental_afterQuery?.(u,x),u.experimental_prefetchInRender&&!ne&&Xe(x,i)&&(w?xe(u,o,d):b.getQueryCache().get(u.queryHash)?.promise)?.catch(ie).finally(()=>{o.updateResult()}),u.notifyOnChangeProps?x:o.trackResult(x)}function et(t,a){return Ze(t,$e)}/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=V("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=V("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=V("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=V("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=V("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=V("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=V("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=V("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=V("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=V("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function he(){return et({queryKey:["categories"],queryFn:async()=>{try{return(await Se(ze(ue(j,"categorias"),Le("nome")))).docs.map(r=>({id:r.id,...r.data()}))}catch(t){throw console.error("Error loading categories:",t),t}},staleTime:10*60*1e3,gcTime:30*60*1e3})}const st="iem94FVEkj3Qjv3DsJXpbQ";async function G(t,a){const r=t.name.split(".").pop()?.toLowerCase()||"jpg";let i="";if(a.type==="main"&&a.productId)i=`${a.productId}.${r}`;else if(a.type==="variation"&&a.productId&&a.variation){const x=a.variation.toLowerCase().replace(/\s+/g,"-");i=`${a.productId}-${x}.${r}`}else i=t.name;const d=new File([t],i,{type:t.type}),b=new FormData;b.append("file",d),b.append("metadata",JSON.stringify({folder:a.folder,productId:a.productId,variation:a.variation,type:a.type,filename:i,uploadDate:new Date().toISOString()}));const u=await fetch("https://imagens.bjeslee19.workers.dev/",{method:"POST",body:b}),w=await u.text();let o;try{o=JSON.parse(w)}catch{o=w}if(!u.ok)throw console.error("Upload error RAW:",o),new Error(typeof o=="string"?o:JSON.stringify(o));if(!o||!o.imageId)throw console.error("Upload OK mas sem imageId:",o),new Error("ID da imagem não retornado pelo servidor");return o.imageId}function ee(t,a="public"){return t?t.startsWith("http://")||t.startsWith("https://")||t.startsWith("blob:")||t.startsWith("data:")?t:`https://imagedelivery.net/${st}/${t}/${a}`:""}async function J(t){if(t&&!(t.startsWith("http://")||t.startsWith("https://"))&&!(t.startsWith("blob:")||t.startsWith("data:")))try{const a=await fetch("https://imagens.bjeslee19.workers.dev/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:t})});if(!a.ok){const r=await a.text();console.error(`Erro ao deletar imagem ${t}:`,r)}}catch(a){console.error(`Erro ao deletar imagem ${t}:`,a)}}const ot="1t7T-5mU4ET0kjqd8x_sXlEwunwogCBrlqFnYpVaoyvE",it="AIzaSyAWUmt2UDeXxY1my2ajGU5bAMSjuU0L14o",nt="produtos!A:Z";function we(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().trim()}function lt(t,a){if(!t||!a)return t;const r=new RegExp(`\\s+${a}$`,"i");return t.replace(r,"").trim()}async function ct(t){const a=t.trim();if(!a)return null;const r=a.split("_"),i=r.length>2?r.slice(0,r.length-1).join("_"):a,d=`https://sheets.googleapis.com/v4/spreadsheets/${ot}/values/${encodeURIComponent(nt)}?key=${it}`,b=await fetch(d);if(!b.ok)throw console.error("Erro ao buscar planilha:",await b.text()),new Error("Não foi possível acessar a planilha do Google Sheets");const w=(await b.json()).values||[];if(!w.length)return null;const[o,...x]=w;console.log("Header da planilha:",o),console.log("Primeira linha de dados:",x[0]);const m=g=>we(g||""),P=o.findIndex(g=>{const y=m(g);return["ID","CODIGO","CÓDIGO","SKU","COD","CODE"].includes(y)}),h=o.findIndex(g=>{const y=m(g);return["NOME","PRODUTO","DESCRICAO_CURTA","NAME"].includes(y)}),v=o.findIndex(g=>{const y=m(g);return["DESCRICAO","DESCRIÇÃO","DESC","DESCRIPTION"].includes(y)}),A=o.findIndex(g=>{const y=m(g);return["COR","CORES","VARIACAO","VARIACOES","VARIAÇÃO","COLOR"].includes(y)}),k=o.findIndex(g=>{const y=m(g);return["CATEGORIA","CATEGORIAS","GRUPO","CATEGORY"].includes(y)}),I=o.findIndex(g=>{const y=m(g);return["DESTAQUE","HIGHLIGHT","FEATURED"].includes(y)});if(P===-1)throw console.error("Colunas disponíveis:",o.map((g,y)=>`${y}: ${g}`)),new Error(`Coluna de código/SKU não encontrada na planilha. Colunas disponíveis: ${o.join(", ")}`);const c=x.filter(g=>{const y=(g[P]||"").trim();return y?y===i||y.startsWith(i+"_"):!1});if(!c.length)return null;let s="",p="";const C=new Set;let S=!1;const D=[];for(const g of c){const y=h>=0?(g[h]||"").trim():"",L=v>=0?(g[v]||"").trim():"",M=A>=0?(g[A]||"").trim():"",N=k>=0?(g[k]||"").trim():"",E=I>=0?(g[I]||"").trim():"";!s&&y&&(s=M?lt(y,M):y),!p&&L&&(p=L),N&&N.split(",").map(O=>O.trim()).filter(Boolean).forEach(O=>C.add(O)),typeof E=="string"&&["SIM","TRUE","1","YES","S"].includes(we(E))&&(S=!0),M&&!D.find(O=>O.cor===M)&&D.push({cor:M})}const R=Array.from(C);return{baseSku:i,nome:s||i,descricao:p,categorias:R,destaque:S,variacoes:D}}function dt(){const[t,a]=l.useState(""),[r,i]=l.useState(""),[d,b]=l.useState(""),[u,w]=l.useState(!1),[o,x]=l.useState([]),[m,P]=l.useState(!1),[h,v]=l.useState(null),[A,k]=l.useState(""),[I,c]=l.useState([]),[s,p]=l.useState(""),[C,S]=l.useState(""),[D,R]=l.useState(!1),[g,y]=l.useState(""),[L,M]=l.useState(!1),{data:N=[]}=he(),E=n=>{const f=n.target.files?.[0];f&&(v(f),k(URL.createObjectURL(f)))},O=()=>{if(s.trim()){const n=s.trim(),f=[...I,{cor:n,image:null,preview:""}];c(f),C||S(n),p("")}},_=(n,f)=>{const z=[...I];z[n].image=f,z[n].preview=URL.createObjectURL(f),c(z)},K=n=>{const f=I[n]?.cor,z=I.filter((U,$)=>$!==n);c(z),S(U=>U&&U===f?z[0]?.cor??"":U)},T=async()=>{const n=r.trim();if(n){M(!0),y("");try{const f=await ct(n);if(!f){y("Nenhum produto encontrado na planilha com esse código.");return}if(i(f.baseSku),f.nome&&a(f.nome),f.descricao&&b(f.descricao),f.categorias?.length&&(x(f.categorias),P(!1)),w(f.destaque),f.variacoes?.length){const z=f.variacoes.map($=>({cor:$.cor,image:null,preview:""}));c(z);const U=f.variacoes.find($=>$.cor.toLowerCase().includes("preto"));U?S(U.cor):f.variacoes[0]?S(f.variacoes[0].cor):S("")}else c([]),S("");y("Dados preenchidos a partir da planilha ✅")}catch(f){console.error(f),y("Erro ao buscar dados na planilha.")}finally{M(!1)}}};return e("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e("h2",{className:"text-xl font-title font-bold mb-6",children:"Adicionar Produto"}),e("form",{onSubmit:async n=>{if(n.preventDefault(),o.length===0){P(!0),y("Selecione pelo menos uma categoria");return}P(!1),R(!0),y("");try{if(!r.trim())throw new Error("Informe um código/SKU");const f=[],z=[];let U=null;const $={};for(const H of I){if(!H.image)continue;const B=await G(H.image,{folder:`produtos/${r}/variacoes`,productId:r,variation:H.cor,type:"variation"});z.push({cor:H.cor,imagem_url:B,thumb_url:B}),f.push(B),$[H.cor]=B}if(h)U=await G(h,{folder:`produtos/${r}`,productId:r,type:"main"}),f.unshift(U);else if(C&&$[C])U=$[C];else{const H=Object.keys($).find(B=>B.toLowerCase().includes("preto"));if(H)U=$[H];else{const B=Object.values($)[0];B&&(U=B)}}if(!U)throw new Error("Envie pelo menos uma imagem (principal ou de alguma variação).");await te(F(ue(j,"produtos"),r),{id:r,nome:t,descricao:d,categorias:o,destaque:u,variacoes:z,imagem_url:U,thumb_url:U,imagens_urls:f,thumbs_urls:f,createdAt:Te()}),y("Produto salvo com sucesso!"),a(""),i(""),b(""),w(!1),x([]),P(!1),v(null),k(""),c([]),p(""),S("")}catch(f){console.error(f),y(f instanceof Error?f.message:"Erro ao salvar produto")}finally{R(!1)}},className:"space-y-4",children:[e("div",{className:"grid md:grid-cols-2 gap-4",children:[e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e("input",{type:"text",value:t,onChange:n=>a(n.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e("div",{className:"flex gap-2",children:[e("input",{type:"text",value:r,onChange:n=>i(n.target.value),onBlur:T,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0}),e("button",{type:"button",onClick:T,disabled:L,className:"px-3 py-2 text-sm rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:L?"Buscando...":"Planilha"})]})]})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e("textarea",{value:d,onChange:n=>b(n.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:["Categorias ",e("span",{className:"text-red-500",children:"*"})]}),e("div",{className:`flex flex-wrap gap-2 p-3 rounded-lg border-2 ${m?"border-red-300 bg-red-50":"border-gray-200"}`,children:N.map(n=>e("label",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-50 border border-gray-200",children:[e("input",{type:"checkbox",checked:o.includes(n.nome),onChange:f=>{P(!1),f.target.checked?x(z=>[...z,n.nome]):x(z=>z.filter(U=>U!==n.nome))},className:"rounded"}),e("span",{className:"text-sm",children:n.nome})]},n.id))}),m&&e("p",{className:"text-xs text-red-500 mt-1",children:"Selecione pelo menos uma categoria"})]}),e("div",{children:e("label",{className:"flex items-center gap-2",children:[e("input",{type:"checkbox",checked:u,onChange:n=>w(n.target.checked),className:"rounded"}),e("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal (opcional)"}),e("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:A?e("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e("img",{src:A,alt:"Preview",className:"w-full h-full object-contain"}),e("button",{type:"button",onClick:()=>{v(null),k("")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1",children:e(X,{size:16})})]}):e("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e(W,{className:"text-gray-400",size:48}),e("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal (opcional)"}),e("input",{type:"file",accept:"image/*",onChange:E,className:"hidden"})]})})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e("div",{className:"flex gap-2 mb-4",children:[e("input",{type:"text",value:s,onChange:n=>p(n.target.value),onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),O())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"}),e("button",{type:"button",onClick:O,className:"bg-primary hover:opacity-90 text-text-primary px-4 py-2 rounded-lg font-semibold",children:"Adicionar"})]}),I.length>0&&e("div",{className:"mb-4",children:[e("label",{className:"block text-sm font-semibold mb-1",children:"Cor principal"}),e("select",{value:C,onChange:n=>S(n.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[e("option",{value:"",children:"Selecione a cor principal"}),I.map((n,f)=>e("option",{value:n.cor,children:n.cor},n.cor+f))]}),e("p",{className:"mt-1 text-xs text-gray-500",children:"Essa cor será usada como principal se você não enviar imagem principal do produto."})]}),e("div",{className:"space-y-3",children:I.map((n,f)=>e("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e("div",{className:"flex-1",children:[e("p",{className:"font-semibold text-sm mb-2",children:n.cor}),n.preview?e("div",{className:"relative w-24 h-24",children:e("img",{src:n.preview,alt:n.cor,className:"w-full h-full object-cover rounded"})}):e("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e(W,{size:16}),e("span",{className:"text-xs",children:"Adicionar imagem"}),e("input",{type:"file",accept:"image/*",onChange:z=>{const U=z.target.files?.[0];U&&_(f,U)},className:"hidden"})]})]}),e("button",{type:"button",onClick:()=>K(f),className:"text-red-500 hover:bg-red-50 p-2 rounded",children:e(X,{size:18})})]},f))})]}),g&&e("p",{className:`text-center font-semibold ${g.includes("sucesso")||g.includes("planilha")?"text-green-600":"text-red-600"}`,children:g}),e("button",{type:"submit",disabled:D,className:"w-full bg-primary hover:opacity-90 text-text-primary font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:D?"Salvando...":"Salvar Produto"})]})]})}function ut({product:t,onClose:a}){const[r,i]=l.useState(t.nome||""),[d,b]=l.useState(t.descricao||""),[u,w]=l.useState(t.destaque||!1),[o,x]=l.useState(t.categorias||[]),[m,P]=l.useState(null),[h,v]=l.useState(t.imagem_url?ee(t.imagem_url,"thumbnail"):""),[A,k]=l.useState(t.variacoes?.map(N=>({cor:N.cor,image:null,preview:ee(N.imagem_url,"thumbnail"),existingUrl:N.imagem_url}))||[]),[I,c]=l.useState(""),[s,p]=l.useState(!1),[C,S]=l.useState(""),{data:D=[]}=he(),R=N=>{const E=N.target.files?.[0];E&&(P(E),v(URL.createObjectURL(E)))},g=()=>{I.trim()&&(k([...A,{cor:I.trim(),image:null,preview:""}]),c(""))},y=(N,E)=>{const O=[...A];O[N].image=E,O[N].preview=URL.createObjectURL(E),k(O)},L=N=>{k(A.filter((E,O)=>O!==N))};return e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:[e("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[e("h2",{className:"text-xl font-title font-bold",children:"Editar Produto"}),e("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e(X,{size:20})})]}),e("form",{onSubmit:async N=>{N.preventDefault(),p(!0),S("");try{let E=t.imagem_url;m&&(E=await G(m,{folder:`produtos/${t.id}`,productId:t.id,type:"main"}),t.imagem_url&&t.imagem_url!==E&&await J(t.imagem_url));const O=[],_=[E],K=t.variacoes?.map(T=>T.imagem_url)||[];for(const T of A)if(T.image){const Q=await G(T.image,{folder:`produtos/${t.id}/variacoes`,productId:t.id,variation:T.cor,type:"variation"});if(O.push({cor:T.cor,imagem_url:Q,thumb_url:Q}),_.push(Q),T.existingUrl&&T.existingUrl!==Q){const n=K.indexOf(T.existingUrl);n>-1&&K.splice(n,1)}}else if(T.existingUrl){const Q=t.variacoes?.find(n=>n.cor===T.cor);if(Q){O.push(Q),_.push(Q.imagem_url);const n=K.indexOf(Q.imagem_url);n>-1&&K.splice(n,1)}}for(const T of K)await J(T);await ce(F(j,"produtos",t.id),{nome:r,descricao:d,categorias:o,destaque:u,variacoes:O,imagem_url:E,thumb_url:E,imagens_urls:_,thumbs_urls:_}),S("Produto atualizado com sucesso!"),setTimeout(()=>a(),1500)}catch(E){console.error(E),S(E instanceof Error?E.message:"Erro ao atualizar produto")}finally{p(!1)}},className:"p-6 space-y-4",children:[e("div",{className:"grid md:grid-cols-2 gap-4",children:[e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e("input",{type:"text",value:r,onChange:N=>i(N.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none",required:!0})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e("input",{type:"text",value:t.id,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e("textarea",{value:d,onChange:N=>b(N.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Categorias"}),e("div",{className:"flex flex-wrap gap-2",children:D.map(N=>e("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[e("input",{type:"checkbox",checked:o.includes(N.nome),onChange:E=>{E.target.checked?x(O=>[...O,N.nome]):x(O=>O.filter(_=>_!==N.nome))},className:"rounded"}),e("span",{className:"text-sm",children:N.nome})]},N.id))})]}),e("div",{children:e("label",{className:"flex items-center gap-2 cursor-pointer",children:[e("input",{type:"checkbox",checked:u,onChange:N=>w(N.target.checked),className:"rounded"}),e("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal"}),e("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:h?e("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e("img",{src:h,alt:"Preview",className:"w-full h-full object-contain"}),e("label",{className:"absolute bottom-2 right-2 bg-primary text-white p-2 rounded-full cursor-pointer hover:opacity-90 shadow-lg transition-opacity",children:[e(W,{size:16}),e("input",{type:"file",accept:"image/*",onChange:R,className:"hidden"})]})]}):e("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e(W,{className:"text-gray-400",size:48}),e("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal"}),e("input",{type:"file",accept:"image/*",onChange:R,className:"hidden"})]})})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e("div",{className:"flex gap-2 mb-4",children:[e("input",{type:"text",value:I,onChange:N=>c(N.target.value),onKeyDown:N=>{N.key==="Enter"&&(N.preventDefault(),g())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"}),e("button",{type:"button",onClick:g,className:"bg-primary hover:opacity-90 text-white px-4 py-2 rounded-lg font-semibold transition-opacity",children:"Adicionar"})]}),e("div",{className:"space-y-3",children:A.map((N,E)=>e("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e("div",{className:"flex-1",children:[e("p",{className:"font-semibold text-sm mb-2",children:N.cor}),N.preview?e("div",{className:"relative w-24 h-24",children:[e("img",{src:N.preview,alt:N.cor,className:"w-full h-full object-cover rounded"}),e("label",{className:"absolute bottom-0 right-0 bg-primary text-white p-1 rounded cursor-pointer hover:opacity-90 shadow-md transition-opacity",children:[e(W,{size:12}),e("input",{type:"file",accept:"image/*",onChange:O=>{const _=O.target.files?.[0];_&&y(E,_)},className:"hidden"})]})]}):e("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50 transition-colors",children:[e(W,{size:16}),e("span",{className:"text-xs",children:"Adicionar imagem"}),e("input",{type:"file",accept:"image/*",onChange:O=>{const _=O.target.files?.[0];_&&y(E,_)},className:"hidden"})]})]}),e("button",{type:"button",onClick:()=>L(E),className:"text-red-500 hover:bg-red-50 p-2 rounded transition-colors",children:e(X,{size:18})})]},E))})]}),C&&e("div",{className:`p-3 rounded-lg text-center font-semibold ${C.includes("sucesso")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:C}),e("button",{type:"submit",disabled:s,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 rounded-lg transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Salvando...":"Salvar Alterações"})]})]})})}function mt(){const[t,a]=l.useState([]),[r,i]=l.useState(!0),[d,b]=l.useState(null),u=async()=>{try{i(!0);const x=(await Se(ue(j,"produtos"))).docs.map(m=>({id:m.id,...m.data()}));a(x)}catch(o){console.error("Erro ao carregar produtos:",o)}finally{i(!1)}};l.useEffect(()=>{u()},[]);const w=async o=>{if(confirm("Tem certeza que deseja excluir este produto?"))try{await Ee(F(j,"produtos",o)),await u()}catch(x){console.error("Erro ao excluir produto:",x),alert("Erro ao excluir produto")}};return r?e("div",{className:"flex justify-center items-center py-12",children:e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e(le,{children:[e("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e("div",{className:"px-6 py-4 border-b border-gray-200",children:e("h2",{className:"text-xl font-semibold",children:["Produtos Cadastrados (",t.length,")"]})}),e("div",{className:"overflow-x-auto",children:e("table",{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:e("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categorias"}),e("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(o=>e("tr",{className:"hover:bg-gray-50",children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:e("div",{className:"flex items-center",children:[o.imagem_url&&e("img",{src:o.imagem_url,alt:o.nome,className:"h-10 w-10 rounded object-cover mr-3"}),e("div",{children:[e("div",{className:"text-sm font-medium text-gray-900",children:o.nome}),e("div",{className:"text-xs text-gray-500",children:o.id})]})]})}),e("td",{className:"px-6 py-4",children:e("div",{className:"flex flex-wrap gap-1",children:o.categorias?.map(x=>e("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary/10 text-primary",children:x},x))})}),e("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e("button",{onClick:()=>b(o),className:"text-primary hover:text-primary-dark mr-4",children:"Editar"}),e("button",{onClick:()=>w(o.id),className:"text-red-600 hover:text-red-900",children:"Excluir"})]})]},o.id))})]})})]}),d&&e(ut,{product:d,onClose:()=>b(null),onSave:()=>{b(null),u()}})]})}function ht(){const[t,a]=l.useState(""),[r,i]=l.useState(!1),[d,b]=l.useState(null),[u,w]=l.useState(""),[o,x]=l.useState(!1),{data:m=[],refetch:P}=he(),h=c=>{const s=c.target.files?.[0];s&&(b(s),w(URL.createObjectURL(s)))},v=async c=>{c.preventDefault(),x(!0);try{const s=t.toLowerCase().replace(/\s+/g,"-");let p="";d&&(p=await G(d,{folder:"categorias",productId:s,type:"category"})),await te(F(j,"categorias",s),{id:s,nome:t,productCount:0,popular:r,imagePath:p}),a(""),i(!1),b(null),w(""),P()}catch(s){console.error(s),alert("Erro ao criar categoria")}finally{x(!1)}},A=async c=>{if(confirm("Tem certeza? Esta ação não pode ser desfeita."))try{c.imagePath&&await J(c.imagePath),await Ee(F(j,"categorias",c.id)),P()}catch(s){console.error(s),alert("Erro ao excluir categoria")}},k=async c=>{try{await ce(F(j,"categorias",c.id),{popular:!c.popular}),P()}catch(s){console.error(s),alert("Não foi possível atualizar popular")}},I=async(c,s)=>{try{const p=await G(s,{folder:"categorias",productId:c.id,type:"category"});c.imagePath&&await J(c.imagePath),await ce(F(j,"categorias",c.id),{imagePath:p}),P()}catch(p){console.error(p),alert("Não foi possível atualizar a imagem")}};return e("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e("h2",{className:"text-xl font-title font-bold mb-6",children:"Gerenciar Categorias"}),e("form",{onSubmit:v,className:"space-y-4 mb-6",children:[e("div",{className:"grid md:grid-cols-2 gap-4",children:[e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Nome da categoria"}),e("input",{type:"text",value:t,onChange:c=>a(c.target.value),placeholder:"Nome da categoria",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Imagem da categoria"}),u?e("div",{className:"relative w-full h-24",children:[e("img",{src:u,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}),e("button",{type:"button",onClick:()=>{b(null),w("")},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1",children:e(X,{size:14})})]}):e("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e(W,{size:16}),e("span",{className:"text-sm",children:"Selecionar imagem"}),e("input",{type:"file",accept:"image/*",onChange:h,className:"hidden"})]})]})]}),e("label",{className:"inline-flex items-center gap-2",children:[e("input",{type:"checkbox",checked:r,onChange:c=>i(c.target.checked),className:"w-4 h-4 rounded"}),e("span",{className:"text-sm font-semibold",children:"Marcar como categoria popular"})]}),e("button",{type:"submit",disabled:o,className:"w-full bg-primary hover:opacity-90 text-text-primary font-semibold px-6 py-3 rounded-lg disabled:opacity-50",children:o?"Criando...":"Criar Categoria"})]}),e("div",{className:"space-y-2",children:m.map(c=>e("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e("div",{className:"flex items-center gap-4 flex-1",children:[c.imagePath&&e("img",{src:je(c.imagePath,"thumbnail"),alt:c.nome,className:"w-16 h-16 object-cover rounded-lg"}),e("div",{className:"flex-1",children:[e("h3",{className:"font-semibold",children:c.nome}),e("p",{className:"text-sm text-gray-500",children:[c.productCount||0," produtos"]}),e("div",{className:"mt-2 flex flex-wrap items-center gap-3",children:[e("button",{onClick:()=>void k(c),className:`px-3 py-1 rounded border text-sm ${c.popular?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300"}`,children:c.popular?"Popular ✓":"Marcar como popular"}),e("label",{className:"flex items-center gap-2 px-3 py-1 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e(W,{size:14}),e("span",{className:"text-xs",children:"Alterar imagem"}),e("input",{type:"file",accept:"image/*",onChange:s=>{const p=s.target.files?.[0];p&&I(c,p)},className:"hidden"})]})]})]})]}),e("button",{onClick:()=>void A(c),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e(rt,{size:18})})]},c.id))})]})}function pt(){const[t,a]=l.useState({banners:[],promotions:[],popups:[]}),[r,i]=l.useState(!1),[d,b]=l.useState(null),[u,w]=l.useState("");l.useEffect(()=>{o()},[]);const o=async()=>{try{const s=await ke(F(j,"config","layout"));s.exists()&&a(s.data())}catch(s){console.error("Erro ao carregar assets:",s),w("Erro ao carregar configurações")}},x=async s=>{await te(F(j,"config","layout"),s)},m=(s,p=3e3)=>{w(s),setTimeout(()=>w(""),p)},P=async s=>{i(!0),b("logo");try{const p=await G(s,{folder:"layout",type:"logo"});t.logo&&await J(t.logo);const C={...t,logo:p};await x(C),a(C),m("Logo atualizado com sucesso!")}catch(p){console.error(p),m("Erro ao fazer upload do logo")}finally{i(!1),b(null)}},h=async(s,p,C,S)=>{i(!0),b(p);try{const D=[];for(let y=0;y<s.length;y++){const L=await G(s[y],{folder:C,type:S});D.push(L)}const R={...t,[p]:[...t[p],...D]};await x(R),a(R),m(`${{banners:"Banners",promotions:"Promoções",popups:"Popups"}[p]} adicionados com sucesso!`)}catch(D){console.error(D),m("Erro ao fazer upload")}finally{i(!1),b(null)}},v=async(s,p)=>{try{const C=t[s][p];await J(C);const S={...t,[s]:t[s].filter((D,R)=>R!==p)};await x(S),a(S),m("Item removido com sucesso!")}catch(C){console.error(C),m("Erro ao remover item")}},A=async()=>{if(t.logo)try{await J(t.logo);const s={...t,logo:void 0};await x(s),a(s),m("Logo removido com sucesso!")}catch(s){console.error(s),m("Erro ao remover logo")}},k=(s,p,C=!1,S=!1,D)=>e("label",{className:`group relative inline-flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-primary/10 to-primary/5 border-2 border-dashed border-primary/30 rounded-xl cursor-pointer hover:border-primary hover:from-primary/20 hover:to-primary/10 transition-all ${S?"opacity-50 cursor-not-allowed":""}`,children:[e("div",{className:"flex items-center justify-center w-10 h-10 bg-white rounded-lg shadow-sm group-hover:shadow-md transition-shadow",children:S?e(tt,{size:20,className:"animate-spin text-primary"}):D||e(W,{size:20,className:"text-primary"})}),e("div",{className:"flex flex-col",children:[e("span",{className:"font-semibold text-gray-800",children:s}),e("span",{className:"text-xs text-gray-500",children:["Clique para selecionar ",C?"arquivos":"arquivo"]})]}),e("input",{type:"file",accept:"image/*",multiple:C,onChange:R=>{R.target.files&&p(R.target.files)},className:"hidden",disabled:r})]}),I=(s,p,C)=>e("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:s.map((S,D)=>e("div",{className:`relative ${C} border-2 border-gray-200 rounded-xl overflow-hidden group hover:border-primary transition-colors bg-gray-50`,children:[e("img",{src:ee(S,"thumbnail"),alt:`${p} ${D+1}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:e("button",{onClick:()=>void v(p,D),className:"opacity-0 group-hover:opacity-100 bg-red-500 hover:bg-red-600 text-white rounded-full p-3 transition-all shadow-lg transform scale-75 group-hover:scale-100",title:"Remover",children:e(X,{size:20})})}),e("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e("p",{className:"text-white text-xs font-medium text-center",children:[p==="banners"?"Banner":p==="promotions"?"Promoção":"Popup"," #",D+1]})})]},`${S}-${D}`))}),c=(s,p)=>e("div",{className:"flex flex-col items-center justify-center py-12 px-4 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[e("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm",children:s}),e("p",{className:"text-sm text-gray-500 font-medium",children:p})]});return e("div",{className:"space-y-8",children:[u&&e("div",{className:`p-4 rounded-xl text-center font-semibold shadow-md animate-fade-in ${u.includes("sucesso")?"bg-green-50 text-green-700 border-2 border-green-200":"bg-red-50 text-red-700 border-2 border-red-200"}`,children:u}),e("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e("div",{className:"flex items-center gap-3 mb-6",children:[e("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e(ve,{size:20,className:"text-primary"})}),e("div",{children:[e("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Logo Principal"}),e("p",{className:"text-sm text-gray-500",children:"Logotipo exibido no cabeçalho do site"})]})]}),t.logo?e("div",{className:"relative inline-block",children:[e("div",{className:"w-64 h-32 border-2 border-gray-200 rounded-xl p-4 group hover:border-primary transition-colors bg-gray-50",children:e("img",{src:ee(t.logo,"thumbnail"),alt:"Logo",className:"w-full h-full object-contain"})}),e("button",{onClick:()=>void A(),className:"absolute -top-3 -right-3 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition-all transform hover:scale-110",title:"Remover logo",children:e(X,{size:18})})]}):k("Adicionar Logo",s=>void P(s[0]),!1,d==="logo",e(ve,{size:20,className:"text-primary"}))]}),e("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e("div",{className:"flex items-center gap-3 mb-6",children:[e("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e(re,{size:20,className:"text-blue-600"})}),e("div",{children:[e("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Banners Hero"}),e("p",{className:"text-sm text-gray-500",children:"Slides principais da página inicial (formato landscape)"})]})]}),e("div",{className:"mb-6",children:k("Adicionar Banners",s=>void h(s,"banners","layout/banners","banner"),!0,d==="banners",e(re,{size:20,className:"text-primary"}))}),t.banners.length>0?I(t.banners,"banners","aspect-video"):c(e(re,{size:28,className:"text-gray-400"}),"Nenhum banner adicionado. Adicione imagens em formato landscape (16:9)")]}),e("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e("div",{className:"flex items-center gap-3 mb-6",children:[e("div",{className:"w-10 h-10 bg-orange-500/10 rounded-lg flex items-center justify-center",children:e(se,{size:20,className:"text-orange-600"})}),e("div",{children:[e("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Promoções em Destaque"}),e("p",{className:"text-sm text-gray-500",children:"Cards de ofertas e promoções especiais (formato quadrado)"})]})]}),e("div",{className:"mb-6",children:k("Adicionar Promoções",s=>void h(s,"promotions","layout/promocoes","promotion"),!0,d==="promotions",e(se,{size:20,className:"text-primary"}))}),t.promotions.length>0?I(t.promotions,"promotions","aspect-square"):c(e(se,{size:28,className:"text-gray-400"}),"Nenhuma promoção adicionada. Use imagens quadradas (1:1) para melhor visualização")]}),e("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e("div",{className:"flex items-center gap-3 mb-6",children:[e("div",{className:"w-10 h-10 bg-purple-500/10 rounded-lg flex items-center justify-center",children:e(ae,{size:20,className:"text-purple-600"})}),e("div",{children:[e("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Popups"}),e("p",{className:"text-sm text-gray-500",children:"Modais promocionais exibidos aos visitantes (formato quadrado)"})]})]}),e("div",{className:"mb-6",children:k("Adicionar Popups",s=>void h(s,"popups","layout/popups","popup"),!0,d==="popups",e(ae,{size:20,className:"text-primary"}))}),t.popups.length>0?I(t.popups,"popups","aspect-square"):c(e(ae,{size:28,className:"text-gray-400"}),"Nenhum popup adicionado. Popups aparecem automaticamente para os visitantes")]})]})}function gt(){const[t,a]=l.useState({whatsappNumber:"",companyName:"",companyEmail:"",companyAddress:""}),[r,i]=l.useState(!1),[d,b]=l.useState(!0),[u,w]=l.useState("");l.useEffect(()=>{o()},[]);const o=async()=>{b(!0);try{const h=await ke(F(j,"config","general"));if(h.exists()){const v=h.data(),A=v.whatsappNumber?.replace(/\D/g,"")||"",k=A.startsWith("55")?A.slice(2):A,I=x(k);a({whatsappNumber:I,companyName:v.companyName||"",companyEmail:v.companyEmail||"",companyAddress:v.companyAddress||""})}}catch(h){console.error("Erro ao carregar configurações:",h),w("Erro ao carregar configurações")}finally{b(!1)}},x=h=>{const v=h.replace(/\D/g,"");return v.length<=2?v:v.length<=7?`(${v.slice(0,2)}) ${v.slice(2)}`:v.length<=11?`(${v.slice(0,2)}) ${v.slice(2,7)}-${v.slice(7)}`:`(${v.slice(0,2)}) ${v.slice(2,7)}-${v.slice(7,11)}`},m=h=>{const v=x(h.target.value);a({...t,whatsappNumber:v})},P=async h=>{h.preventDefault(),i(!0),w("");try{let v=t.whatsappNumber.replace(/\D/g,"");if(v.length<10||v.length>11){w("Número de WhatsApp inválido"),i(!1);return}const A=`55${v}`;await te(F(j,"config","general"),{whatsappNumber:A,companyName:t.companyName,companyEmail:t.companyEmail||"",companyAddress:t.companyAddress||"",updatedAt:new Date().toISOString()}),w("Configurações salvas com sucesso!"),setTimeout(()=>w(""),3e3)}catch(v){console.error("Erro ao salvar configurações:",v),w("Erro ao salvar configurações")}finally{i(!1)}};return d?e("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e("div",{className:"flex items-center justify-center py-12",children:e("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin"})})}):e("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e("div",{className:"flex items-center gap-3 mb-6",children:[e(Ne,{className:"text-primary",size:24}),e("h2",{className:"text-xl font-title font-bold",children:"Configurações Gerais"})]}),e("form",{onSubmit:P,className:"space-y-6",children:[e("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e("p",{className:"text-sm text-blue-800",children:[e("strong",{children:"Importante:"})," O número de WhatsApp configurado aqui será usado para receber todos os pedidos do catálogo."]})}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Número do WhatsApp *"}),e("div",{className:"relative",children:[e(Ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e("input",{type:"text",value:t.whatsappNumber,onChange:m,placeholder:"(00) 00000-0000",className:"w-full pl-11 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e("p",{className:"text-xs text-gray-500 mt-1",children:"Digite apenas números. Ex: 5589994333316"})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Nome da Empresa *"}),e("input",{type:"text",value:t.companyName,onChange:h=>a({...t,companyName:h.target.value}),placeholder:"Rocha Brindes",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"E-mail da Empresa"}),e("input",{type:"email",value:t.companyEmail,onChange:h=>a({...t,companyEmail:h.target.value}),placeholder:"contato@rochabrindes.com.br",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),e("div",{children:[e("label",{className:"block text-sm font-semibold mb-2",children:"Endereço da Empresa"}),e("textarea",{value:t.companyAddress,onChange:h=>a({...t,companyAddress:h.target.value}),placeholder:"Rua Exemplo, 123 - Bairro - Cidade - Estado",rows:3,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),u&&e("div",{className:`p-4 rounded-lg text-center font-semibold ${u.includes("sucesso")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:u}),e("button",{type:"submit",disabled:r,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 px-6 rounded-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:r?e(le,{children:[e("div",{className:"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"}),"Salvando..."]}):e(le,{children:[e(at,{size:20}),"Salvar Configurações"]})})]}),e("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e("h3",{className:"font-semibold text-sm mb-2",children:"Prévia do número configurado:"}),e("p",{className:"text-lg font-mono text-primary",children:t.whatsappNumber||"(Nenhum número configurado)"}),t.whatsappNumber&&e("p",{className:"text-xs text-gray-500 mt-1",children:["Link: https://wa.me/",t.whatsappNumber.replace(/\D/g,"")]})]})]})}function Nt(){const[t,a]=l.useState("products");return e("div",{className:"min-h-screen bg-gray-50",children:[e("header",{className:"bg-white shadow-sm",children:e("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[e("h1",{className:"text-2xl font-title font-bold",children:"Painel Admin"}),e("button",{onClick:async()=>{await Me(_e)},className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg",children:"Sair"})]})}),e("div",{className:"container mx-auto px-4 py-8",children:[e("div",{className:"flex gap-4 mb-6 overflow-x-auto",children:[e("button",{onClick:()=>a("products"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${t==="products"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Produtos"}),e("button",{onClick:()=>a("categories"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${t==="categories"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Categorias"}),e("button",{onClick:()=>a("layout"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${t==="layout"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Layout"}),e("button",{onClick:()=>a("config"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${t==="config"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Configurações"})]}),t==="products"&&e("div",{className:"space-y-8",children:[e(dt,{}),e(mt,{})]}),t==="categories"&&e(ht,{}),t==="layout"&&e(pt,{}),t==="config"&&e(gt,{})]})]})}export{Nt as default};

import{q as re,o as te,c as Y,d as $,g as me,j as e,s as Z,b as M,h as fe,u as oe,i as be,l as ne,k as ye,m as ue,a as pe,n as je,f as ve}from"./Providers.xGLPAwM3.js";import{r as l}from"./index.Ba-IbuDT.js";import{c as B,u as ge,o as he,C as Ne,a as we}from"./chevron-right.BkMAVnk-.js";import{X as J}from"./x.D_7acxyf.js";import{S as Ce}from"./search.DWvdi_od.js";import{T as xe}from"./trash-2.CSJwb4X7.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=B("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=B("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=B("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=B("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=B("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=B("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=B("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=B("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=B("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function ie(){return ge({queryKey:["categories"],queryFn:async()=>{const s=re(Y($,"categorias"),te("nome"));return(await me(s)).docs.map(i=>({id:i.id,...i.data()}))},staleTime:5*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1})}const Ie="iem94FVEkj3Qjv3DsJXpbQ";async function G(s,t){const i=s.name.split(".").pop()?.toLowerCase()||"jpg";let y="";if(t.type==="main"&&t.productId)y=`${t.productId}.${i}`;else if(t.type==="variation"&&t.productId&&t.variation){const E=t.variation.toLowerCase().replace(/\s+/g,"-");y=`${t.productId}-${E}.${i}`}else y=s.name;const A=new File([s],y,{type:s.type}),C=new FormData;C.append("file",A),C.append("metadata",JSON.stringify({folder:t.folder,productId:t.productId,variation:t.variation,type:t.type,filename:y,uploadDate:new Date().toISOString()}));const k=await fetch("https://imagens.bjeslee19.workers.dev/",{method:"POST",body:C}),v=await k.text();let p;try{p=JSON.parse(v)}catch{p=v}if(!k.ok)throw console.error("Upload error RAW:",p),new Error(typeof p=="string"?p:JSON.stringify(p));if(!p||!p.imageId)throw console.error("Upload OK mas sem imageId:",p),new Error("ID da imagem não retornado pelo servidor");return p.imageId}function X(s,t="public"){return s?s.startsWith("http://")||s.startsWith("https://")||s.startsWith("blob:")||s.startsWith("data:")?s:`https://imagedelivery.net/${Ie}/${s}/${t}`:""}async function Q(s){if(s&&!(s.startsWith("http://")||s.startsWith("https://"))&&!(s.startsWith("blob:")||s.startsWith("data:")))try{const t=await fetch("https://imagens.bjeslee19.workers.dev/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:s})});if(!t.ok){const i=await t.text();console.error(`Erro ao deletar imagem ${s}:`,i)}}catch(t){console.error(`Erro ao deletar imagem ${s}:`,t)}}async function Ae(s){const t=s.filter(i=>i&&!i.startsWith("http")&&!i.startsWith("blob:")&&!i.startsWith("data:"));if(t.length!==0)try{const i=await fetch("https://imagens.bjeslee19.workers.dev/delete-multiple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageIds:t})});if(!i.ok){const y=await i.text();console.error("Erro ao deletar múltiplas imagens:",y)}}catch(i){console.error("Erro ao deletar múltiplas imagens:",i)}}const ze="1t7T-5mU4ET0kjqd8x_sXlEwunwogCBrlqFnYpVaoyvE",Pe="AIzaSyAWUmt2UDeXxY1my2ajGU5bAMSjuU0L14o",De="produtos!A:Z";function de(s){return s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().trim()}function Le(s,t){if(!s||!t)return s;const i=new RegExp(`\\s+${t}$`,"i");return s.replace(i,"").trim()}async function _e(s){const t=s.trim();if(!t)return null;const i=t.split("_"),y=i.length>2?i.slice(0,i.length-1).join("_"):t,A=`https://sheets.googleapis.com/v4/spreadsheets/${ze}/values/${encodeURIComponent(De)}?key=${Pe}`,C=await fetch(A);if(!C.ok)throw console.error("Erro ao buscar planilha:",await C.text()),new Error("Não foi possível acessar a planilha do Google Sheets");const v=(await C.json()).values||[];if(!v.length)return null;const[p,...E]=v;console.log("Header da planilha:",p),console.log("Primeira linha de dados:",E[0]);const j=h=>de(h||""),z=p.findIndex(h=>{const x=j(h);return["ID","CODIGO","CÓDIGO","SKU","COD","CODE"].includes(x)}),b=p.findIndex(h=>{const x=j(h);return["NOME","PRODUTO","DESCRICAO_CURTA","NAME"].includes(x)}),u=p.findIndex(h=>{const x=j(h);return["DESCRICAO","DESCRIÇÃO","DESC","DESCRIPTION"].includes(x)}),L=p.findIndex(h=>{const x=j(h);return["COR","CORES","VARIACAO","VARIACOES","VARIAÇÃO","COLOR"].includes(x)}),D=p.findIndex(h=>{const x=j(h);return["CATEGORIA","CATEGORIAS","GRUPO","CATEGORY"].includes(x)}),I=p.findIndex(h=>{const x=j(h);return["DESTAQUE","HIGHLIGHT","FEATURED"].includes(x)});if(z===-1)throw console.error("Colunas disponíveis:",p.map((h,x)=>`${x}: ${h}`)),new Error(`Coluna de código/SKU não encontrada na planilha. Colunas disponíveis: ${p.join(", ")}`);const n=E.filter(h=>{const x=(h[z]||"").trim();return x?x===y||x.startsWith(y+"_"):!1});if(!n.length)return null;let r="",d="";const N=new Set;let a=!1;const c=[];for(const h of n){const x=b>=0?(h[b]||"").trim():"",V=u>=0?(h[u]||"").trim():"",T=L>=0?(h[L]||"").trim():"",g=D>=0?(h[D]||"").trim():"",w=I>=0?(h[I]||"").trim():"";!r&&x&&(r=T?Le(x,T):x),!d&&V&&(d=V),g&&g.split(",").map(S=>S.trim()).filter(Boolean).forEach(S=>N.add(S)),typeof w=="string"&&["SIM","TRUE","1","YES","S"].includes(de(w))&&(a=!0),T&&!c.find(S=>S.cor===T)&&c.push({cor:T})}const f=Array.from(N);return{baseSku:y,nome:r||y,descricao:d,categorias:f,destaque:a,variacoes:c}}function qe(){const[s,t]=l.useState(""),[i,y]=l.useState(""),[A,C]=l.useState(""),[k,v]=l.useState(!1),[p,E]=l.useState([]),[j,z]=l.useState(!1),[b,u]=l.useState(null),[L,D]=l.useState(""),[I,n]=l.useState([]),[r,d]=l.useState(""),[N,a]=l.useState(""),[c,f]=l.useState(!1),[h,x]=l.useState(""),[V,T]=l.useState(!1),{data:g=[]}=ie(),w=o=>{const m=o.target.files?.[0];m&&(u(m),D(URL.createObjectURL(m)))},S=()=>{if(r.trim()){const o=r.trim(),m=[...I,{cor:o,image:null,preview:""}];n(m),N||a(o),d("")}},O=(o,m)=>{const _=[...I];_[o].image=m,_[o].preview=URL.createObjectURL(m),n(_)},H=o=>{const m=I[o]?.cor,_=I.filter((P,R)=>R!==o);n(_),a(P=>P&&P===m?_[0]?.cor??"":P)},q=async()=>{const o=i.trim();if(o){T(!0),x("");try{const m=await _e(o);if(!m){x("Nenhum produto encontrado na planilha com esse código.");return}if(y(m.baseSku),m.nome&&t(m.nome),m.descricao&&C(m.descricao),m.categorias?.length&&(E(m.categorias),z(!1)),v(m.destaque),m.variacoes?.length){const _=m.variacoes.map(R=>({cor:R.cor,image:null,preview:""}));n(_);const P=m.variacoes.find(R=>R.cor.toLowerCase().includes("preto"));P?a(P.cor):m.variacoes[0]?a(m.variacoes[0].cor):a("")}else n([]),a("");x("Dados preenchidos a partir da planilha ✅")}catch(m){console.error(m),x("Erro ao buscar dados na planilha.")}finally{T(!1)}}},U=async o=>{if(o.preventDefault(),p.length===0){z(!0),x("Selecione pelo menos uma categoria");return}z(!1),f(!0),x("");try{if(!i.trim())throw new Error("Informe um código/SKU");const m=[],_=[];let P=null;const R={};for(const K of I){if(!K.image)continue;const W=await G(K.image,{folder:`produtos/${i}/variacoes`,productId:i,variation:K.cor,type:"variation"});_.push({cor:K.cor,imagem_url:W,thumb_url:W}),m.push(W),R[K.cor]=W}if(b)P=await G(b,{folder:`produtos/${i}`,productId:i,type:"main"}),m.unshift(P);else if(N&&R[N])P=R[N];else{const K=Object.keys(R).find(W=>W.toLowerCase().includes("preto"));if(K)P=R[K];else{const W=Object.values(R)[0];W&&(P=W)}}if(!P)throw new Error("Envie pelo menos uma imagem (principal ou de alguma variação).");await Z(M(Y($,"produtos"),i),{id:i,nome:s,descricao:A,categorias:p,destaque:k,variacoes:_,imagem_url:P,thumb_url:P,imagens_urls:m,thumbs_urls:m,createdAt:fe()}),x("Produto salvo com sucesso!"),t(""),y(""),C(""),v(!1),E([]),z(!1),u(null),D(""),n([]),d(""),a("")}catch(m){console.error(m),x(m instanceof Error?m.message:"Erro ao salvar produto")}finally{f(!1)}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Adicionar Produto"}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:s,onChange:o=>t(o.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:i,onChange:o=>y(o.target.value),onBlur:q,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0}),e.jsx("button",{type:"button",onClick:q,disabled:V,className:"px-3 py-2 text-sm rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:V?"Buscando...":"Planilha"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:A,onChange:o=>C(o.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold mb-2",children:["Categorias ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:`flex flex-wrap gap-2 p-3 rounded-lg border-2 ${j?"border-red-300 bg-red-50":"border-gray-200"}`,children:g.map(o=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-50 border border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:p.includes(o.nome),onChange:m=>{z(!1),m.target.checked?E(_=>[..._,o.nome]):E(_=>_.filter(P=>P!==o.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:o.nome})]},o.id))}),j&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Selecione pelo menos uma categoria"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:o=>v(o.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal (opcional)"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:L?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:L,alt:"Preview",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",onClick:()=>{u(null),D("")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1",children:e.jsx(J,{size:16})})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(F,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal (opcional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:r,onChange:o=>d(o.target.value),onKeyDown:o=>{o.key==="Enter"&&(o.preventDefault(),S())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"}),e.jsx("button",{type:"button",onClick:S,className:"bg-primary hover:opacity-90 text-text-primary px-4 py-2 rounded-lg font-semibold",children:"Adicionar"})]}),I.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Cor principal"}),e.jsxs("select",{value:N,onChange:o=>a(o.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Selecione a cor principal"}),I.map((o,m)=>e.jsx("option",{value:o.cor,children:o.cor},o.cor+m))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Essa cor será usada como principal se você não enviar imagem principal do produto."})]}),e.jsx("div",{className:"space-y-3",children:I.map((o,m)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:o.cor}),o.preview?e.jsx("div",{className:"relative w-24 h-24",children:e.jsx("img",{src:o.preview,alt:o.cor,className:"w-full h-full object-cover rounded"})}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(F,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:_=>{const P=_.target.files?.[0];P&&O(m,P)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>H(m),className:"text-red-500 hover:bg-red-50 p-2 rounded",children:e.jsx(J,{size:18})})]},m))})]}),h&&e.jsx("p",{className:`text-center font-semibold ${h.includes("sucesso")||h.includes("planilha")?"text-green-600":"text-red-600"}`,children:h}),e.jsx("button",{type:"submit",disabled:c,className:"w-full bg-primary hover:opacity-90 text-text-primary font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:c?"Salvando...":"Salvar Produto"})]})]})}function Oe({product:s,onClose:t}){const[i,y]=l.useState(s.nome||""),[A,C]=l.useState(s.descricao||""),[k,v]=l.useState(s.destaque||!1),[p,E]=l.useState(s.categorias||[]),[j,z]=l.useState(null),[b,u]=l.useState(s.imagem_url?X(s.imagem_url,"thumbnail"):""),[L,D]=l.useState(s.variacoes?.map(g=>({cor:g.cor,image:null,preview:X(g.imagem_url,"thumbnail"),existingUrl:g.imagem_url}))||[]),[I,n]=l.useState(""),[r,d]=l.useState(!1),[N,a]=l.useState(""),{data:c=[]}=ie(),f=g=>{const w=g.target.files?.[0];w&&(z(w),u(URL.createObjectURL(w)))},h=()=>{I.trim()&&(D([...L,{cor:I.trim(),image:null,preview:""}]),n(""))},x=(g,w)=>{const S=[...L];S[g].image=w,S[g].preview=URL.createObjectURL(w),D(S)},V=g=>{D(L.filter((w,S)=>S!==g))},T=async g=>{g.preventDefault(),d(!0),a("");try{let w=s.imagem_url;j&&(w=await G(j,{folder:`produtos/${s.id}`,productId:s.id,type:"main"}),s.imagem_url&&s.imagem_url!==w&&await Q(s.imagem_url));const S=[],O=[w],H=s.variacoes?.map(q=>q.imagem_url)||[];for(const q of L)if(q.image){const U=await G(q.image,{folder:`produtos/${s.id}/variacoes`,productId:s.id,variation:q.cor,type:"variation"});if(S.push({cor:q.cor,imagem_url:U,thumb_url:U}),O.push(U),q.existingUrl&&q.existingUrl!==U){const o=H.indexOf(q.existingUrl);o>-1&&H.splice(o,1)}}else if(q.existingUrl){const U=s.variacoes?.find(o=>o.cor===q.cor);if(U){S.push(U),O.push(U.imagem_url);const o=H.indexOf(U.imagem_url);o>-1&&H.splice(o,1)}}for(const q of H)await Q(q);await oe(M($,"produtos",s.id),{nome:i,descricao:A,categorias:p,destaque:k,variacoes:S,imagem_url:w,thumb_url:w,imagens_urls:O,thumbs_urls:O}),a("Produto atualizado com sucesso!"),setTimeout(()=>t(),1500)}catch(w){console.error(w),a(w instanceof Error?w.message:"Erro ao atualizar produto")}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{className:"text-xl font-title font-bold",children:"Editar Produto"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(J,{size:20})})]}),e.jsxs("form",{onSubmit:T,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:i,onChange:g=>y(g.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsx("input",{type:"text",value:s.id,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:A,onChange:g=>C(g.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Categorias"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(g=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:p.includes(g.nome),onChange:w=>{w.target.checked?E(S=>[...S,g.nome]):E(S=>S.filter(O=>O!==g.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:g.nome})]},g.id))})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:g=>v(g.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:b?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:b,alt:"Preview",className:"w-full h-full object-contain"}),e.jsxs("label",{className:"absolute bottom-2 right-2 bg-primary text-white p-2 rounded-full cursor-pointer hover:opacity-90 shadow-lg transition-opacity",children:[e.jsx(F,{size:16}),e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"hidden"})]})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(F,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal"}),e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"hidden"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:I,onChange:g=>n(g.target.value),onKeyDown:g=>{g.key==="Enter"&&(g.preventDefault(),h())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"}),e.jsx("button",{type:"button",onClick:h,className:"bg-primary hover:opacity-90 text-white px-4 py-2 rounded-lg font-semibold transition-opacity",children:"Adicionar"})]}),e.jsx("div",{className:"space-y-3",children:L.map((g,w)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:g.cor}),g.preview?e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("img",{src:g.preview,alt:g.cor,className:"w-full h-full object-cover rounded"}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary text-white p-1 rounded cursor-pointer hover:opacity-90 shadow-md transition-opacity",children:[e.jsx(F,{size:12}),e.jsx("input",{type:"file",accept:"image/*",onChange:S=>{const O=S.target.files?.[0];O&&x(w,O)},className:"hidden"})]})]}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx(F,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:S=>{const O=S.target.files?.[0];O&&x(w,O)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>V(w),className:"text-red-500 hover:bg-red-50 p-2 rounded transition-colors",children:e.jsx(J,{size:18})})]},w))})]}),N&&e.jsx("div",{className:`p-3 rounded-lg text-center font-semibold ${N.includes("sucesso")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:N}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 rounded-lg transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Salvando...":"Salvar Alterações"})]})]})})}function $e(){const[s,t]=l.useState(0),[i,y]=l.useState([]),[A,C]=l.useState(null),[k,v]=l.useState(null),[p,E]=l.useState(""),j=50,z=be(),b=l.useMemo(()=>{const a=re(Y($,"produtos"),te("createdAt","desc"),ne(j));return s>0&&i[s-1]?re(Y($,"produtos"),te("createdAt","desc"),ye(i[s-1]),ne(j)):a},[s,i,j]),{data:u=[],isLoading:L,refetch:D,isFetching:I}=ge({queryKey:["admin-products",s,j,i[s-1]?.id],queryFn:async()=>{const c=(await me(b)).docs;return c.length>0&&y(f=>{const h=[...f];return h[s]=c[c.length-1],h}),c.map(f=>({id:f.id,...f.data()}))},placeholderData:a=>a??[],staleTime:3e4}),n=l.useMemo(()=>{if(!p.trim())return u;const a=p.toLowerCase();return u.filter(c=>c.nome.toLowerCase().includes(a)||c.id.toLowerCase().includes(a))},[u,p]),r=async a=>{if(confirm(`Tem certeza que deseja excluir "${a.nome}"?`)){v(a.id);try{const c=[];a.imagem_url&&c.push(a.imagem_url),a.thumb_url&&a.thumb_url!==a.imagem_url&&c.push(a.thumb_url),a.imagens_urls?.length&&a.imagens_urls.forEach(f=>{c.includes(f)||c.push(f)}),a.thumbs_urls?.length&&a.thumbs_urls.forEach(f=>{c.includes(f)||c.push(f)}),a.variacoes?.length&&a.variacoes.forEach(f=>{f.imagem_url&&!c.includes(f.imagem_url)&&c.push(f.imagem_url),f.thumb_url&&!c.includes(f.thumb_url)&&c.push(f.thumb_url)}),await Ae(c),await ue(M($,"produtos",a.id)),await z.invalidateQueries({queryKey:["admin-products"]}),await D()}catch(c){console.error("Erro ao deletar produto:",c),alert("Erro ao deletar produto")}finally{v(null)}}},d=a=>{C(a)},N=()=>{C(null),z.invalidateQueries({queryKey:["admin-products"]}),D()};return L&&!u.length?e.jsx("div",{className:"text-center py-8",children:"Carregando produtos..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("h2",{className:"text-xl font-title font-bold",children:["Produtos Cadastrados ",I&&e.jsx("span",{className:"text-sm text-gray-400",children:"(atualizando…)"})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("input",{type:"text",value:p,onChange:a=>E(a.target.value),placeholder:"Buscar por nome ou SKU...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none text-sm"}),e.jsx(Ce,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18})]})]})}),e.jsx("div",{className:"max-h-[600px] overflow-auto divide-y",children:n.map(a=>{const c=a.thumb_url||a.imagem_url||a.imagens_urls?.[0],f=c?he(c,"thumbnail"):"";return e.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 hover:bg-gray-50",children:[f?e.jsx("img",{src:f,alt:a.nome??"Produto",className:"w-16 h-16 object-contain rounded bg-gray-50"}):e.jsx("div",{className:"w-16 h-16 flex items-center justify-center bg-gray-100 rounded",children:e.jsx("span",{className:"text-xs text-gray-400",children:"Sem img"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:a.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",a.id]}),e.jsx("div",{className:"flex gap-2 mt-1 flex-wrap",children:a.categorias?.map(h=>e.jsx("span",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:h},h))}),a.variacoes&&a.variacoes.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.variacoes.length," variações de cor"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Editar",disabled:k===a.id,children:e.jsx(ke,{size:18})}),e.jsx("button",{onClick:()=>r(a),className:"p-2 text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Excluir",disabled:k===a.id,children:k===a.id?e.jsx("div",{className:"w-[18px] h-[18px] border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):e.jsx(xe,{size:18})})]})]},a.id)})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>t(a=>Math.max(0,a-1)),disabled:s===0,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:[e.jsx(Ne,{size:18}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",s+1]}),e.jsxs("button",{onClick:()=>t(a=>a+1),disabled:u.length<j,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:["Próximo",e.jsx(we,{size:18})]})]})]}),A&&e.jsx(Oe,{product:A,onClose:N})]})}function Re(){const[s,t]=l.useState(""),[i,y]=l.useState(!1),[A,C]=l.useState(null),[k,v]=l.useState(""),[p,E]=l.useState(!1),{data:j=[],refetch:z}=ie(),b=n=>{const r=n.target.files?.[0];r&&(C(r),v(URL.createObjectURL(r)))},u=async n=>{n.preventDefault(),E(!0);try{const r=s.toLowerCase().replace(/\s+/g,"-");let d="";A&&(d=await G(A,{folder:"categorias",productId:r,type:"category"})),await Z(M($,"categorias",r),{id:r,nome:s,productCount:0,popular:i,imagePath:d}),t(""),y(!1),C(null),v(""),z()}catch(r){console.error(r),alert("Erro ao criar categoria")}finally{E(!1)}},L=async n=>{if(confirm("Tem certeza? Esta ação não pode ser desfeita."))try{n.imagePath&&await Q(n.imagePath),await ue(M($,"categorias",n.id)),z()}catch(r){console.error(r),alert("Erro ao excluir categoria")}},D=async n=>{try{await oe(M($,"categorias",n.id),{popular:!n.popular}),z()}catch(r){console.error(r),alert("Não foi possível atualizar popular")}},I=async(n,r)=>{try{const d=await G(r,{folder:"categorias",productId:n.id,type:"category"});n.imagePath&&await Q(n.imagePath),await oe(M($,"categorias",n.id),{imagePath:d}),z()}catch(d){console.error(d),alert("Não foi possível atualizar a imagem")}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Gerenciar Categorias"}),e.jsxs("form",{onSubmit:u,className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome da categoria"}),e.jsx("input",{type:"text",value:s,onChange:n=>t(n.target.value),placeholder:"Nome da categoria",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem da categoria"}),k?e.jsxs("div",{className:"relative w-full h-24",children:[e.jsx("img",{src:k,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{C(null),v("")},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1",children:e.jsx(J,{size:14})})]}):e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx(F,{size:16}),e.jsx("span",{className:"text-sm",children:"Selecionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:b,className:"hidden"})]})]})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:n=>y(n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Marcar como categoria popular"})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-primary hover:opacity-90 text-text-primary font-semibold px-6 py-3 rounded-lg disabled:opacity-50",children:p?"Criando...":"Criar Categoria"})]}),e.jsx("div",{className:"space-y-2",children:j.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[n.imagePath&&e.jsx("img",{src:he(n.imagePath,"thumbnail"),alt:n.nome,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:n.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.productCount||0," produtos"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3",children:[e.jsx("button",{onClick:()=>void D(n),className:`px-3 py-1 rounded border text-sm ${n.popular?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300"}`,children:n.popular?"Popular ✓":"Marcar como popular"}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-1 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(F,{size:14}),e.jsx("span",{className:"text-xs",children:"Alterar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:r=>{const d=r.target.files?.[0];d&&I(n,d)},className:"hidden"})]})]})]})]}),e.jsx("button",{onClick:()=>void L(n),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(xe,{size:18})})]},n.id))})]})}function Ue(){const[s,t]=l.useState({banners:[],promotions:[],popups:[]}),[i,y]=l.useState(!1),[A,C]=l.useState(null),[k,v]=l.useState("");l.useEffect(()=>{p()},[]);const p=async()=>{try{const r=await pe(M($,"config","layout"));r.exists()&&t(r.data())}catch(r){console.error("Erro ao carregar assets:",r),v("Erro ao carregar configurações")}},E=async r=>{await Z(M($,"config","layout"),r)},j=(r,d=3e3)=>{v(r),setTimeout(()=>v(""),d)},z=async r=>{y(!0),C("logo");try{const d=await G(r,{folder:"layout",type:"logo"});s.logo&&await Q(s.logo);const N={...s,logo:d};await E(N),t(N),j("Logo atualizado com sucesso!")}catch(d){console.error(d),j("Erro ao fazer upload do logo")}finally{y(!1),C(null)}},b=async(r,d,N,a)=>{y(!0),C(d);try{const c=[];for(let x=0;x<r.length;x++){const V=await G(r[x],{folder:N,type:a});c.push(V)}const f={...s,[d]:[...s[d],...c]};await E(f),t(f),j(`${{banners:"Banners",promotions:"Promoções",popups:"Popups"}[d]} adicionados com sucesso!`)}catch(c){console.error(c),j("Erro ao fazer upload")}finally{y(!1),C(null)}},u=async(r,d)=>{try{const N=s[r][d];await Q(N);const a={...s,[r]:s[r].filter((c,f)=>f!==d)};await E(a),t(a),j("Item removido com sucesso!")}catch(N){console.error(N),j("Erro ao remover item")}},L=async()=>{if(s.logo)try{await Q(s.logo);const r={...s,logo:void 0};await E(r),t(r),j("Logo removido com sucesso!")}catch(r){console.error(r),j("Erro ao remover logo")}},D=(r,d,N=!1,a=!1,c)=>e.jsxs("label",{className:`group relative inline-flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-primary/10 to-primary/5 border-2 border-dashed border-primary/30 rounded-xl cursor-pointer hover:border-primary hover:from-primary/20 hover:to-primary/10 transition-all ${a?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-white rounded-lg shadow-sm group-hover:shadow-md transition-shadow",children:a?e.jsx(Se,{size:20,className:"animate-spin text-primary"}):c||e.jsx(F,{size:20,className:"text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:r}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Clique para selecionar ",N?"arquivos":"arquivo"]})]}),e.jsx("input",{type:"file",accept:"image/*",multiple:N,onChange:f=>{f.target.files&&d(f.target.files)},className:"hidden",disabled:i})]}),I=(r,d,N)=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:r.map((a,c)=>e.jsxs("div",{className:`relative ${N} border-2 border-gray-200 rounded-xl overflow-hidden group hover:border-primary transition-colors bg-gray-50`,children:[e.jsx("img",{src:X(a,"thumbnail"),alt:`${d} ${c+1}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:e.jsx("button",{onClick:()=>void u(d,c),className:"opacity-0 group-hover:opacity-100 bg-red-500 hover:bg-red-600 text-white rounded-full p-3 transition-all shadow-lg transform scale-75 group-hover:scale-100",title:"Remover",children:e.jsx(J,{size:20})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("p",{className:"text-white text-xs font-medium text-center",children:[d==="banners"?"Banner":d==="promotions"?"Promoção":"Popup"," #",c+1]})})]},`${a}-${c}`))}),n=(r,d)=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm",children:r}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:d})]});return e.jsxs("div",{className:"space-y-8",children:[k&&e.jsx("div",{className:`p-4 rounded-xl text-center font-semibold shadow-md animate-fade-in ${k.includes("sucesso")?"bg-green-50 text-green-700 border-2 border-green-200":"bg-red-50 text-red-700 border-2 border-red-200"}`,children:k}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(le,{size:20,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Logo Principal"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Logotipo exibido no cabeçalho do site"})]})]}),s.logo?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-64 h-32 border-2 border-gray-200 rounded-xl p-4 group hover:border-primary transition-colors bg-gray-50",children:e.jsx("img",{src:X(s.logo,"thumbnail"),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsx("button",{onClick:()=>void L(),className:"absolute -top-3 -right-3 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition-all transform hover:scale-110",title:"Remover logo",children:e.jsx(J,{size:18})})]}):D("Adicionar Logo",r=>void z(r[0]),!1,A==="logo",e.jsx(le,{size:20,className:"text-primary"}))]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e.jsx(se,{size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Banners Hero"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Slides principais da página inicial (formato landscape)"})]})]}),e.jsx("div",{className:"mb-6",children:D("Adicionar Banners",r=>void b(r,"banners","layout/banners","banner"),!0,A==="banners",e.jsx(se,{size:20,className:"text-primary"}))}),s.banners.length>0?I(s.banners,"banners","aspect-video"):n(e.jsx(se,{size:28,className:"text-gray-400"}),"Nenhum banner adicionado. Adicione imagens em formato landscape (16:9)")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/10 rounded-lg flex items-center justify-center",children:e.jsx(ae,{size:20,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Promoções em Destaque"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Cards de ofertas e promoções especiais (formato quadrado)"})]})]}),e.jsx("div",{className:"mb-6",children:D("Adicionar Promoções",r=>void b(r,"promotions","layout/promocoes","promotion"),!0,A==="promotions",e.jsx(ae,{size:20,className:"text-primary"}))}),s.promotions.length>0?I(s.promotions,"promotions","aspect-square"):n(e.jsx(ae,{size:28,className:"text-gray-400"}),"Nenhuma promoção adicionada. Use imagens quadradas (1:1) para melhor visualização")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/10 rounded-lg flex items-center justify-center",children:e.jsx(ee,{size:20,className:"text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Popups"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Modais promocionais exibidos aos visitantes (formato quadrado)"})]})]}),e.jsx("div",{className:"mb-6",children:D("Adicionar Popups",r=>void b(r,"popups","layout/popups","popup"),!0,A==="popups",e.jsx(ee,{size:20,className:"text-primary"}))}),s.popups.length>0?I(s.popups,"popups","aspect-square"):n(e.jsx(ee,{size:28,className:"text-gray-400"}),"Nenhum popup adicionado. Popups aparecem automaticamente para os visitantes")]})]})}function Me(){const[s,t]=l.useState({whatsappNumber:"",companyName:"",companyEmail:"",companyAddress:""}),[i,y]=l.useState(!1),[A,C]=l.useState(!0),[k,v]=l.useState("");l.useEffect(()=>{p()},[]);const p=async()=>{C(!0);try{const b=await pe(M($,"config","general"));if(b.exists()){const u=b.data();t({whatsappNumber:u.whatsappNumber||"",companyName:u.companyName||"",companyEmail:u.companyEmail||"",companyAddress:u.companyAddress||""})}}catch(b){console.error("Erro ao carregar configurações:",b),v("Erro ao carregar configurações")}finally{C(!1)}},E=b=>{const u=b.replace(/\D/g,"");return u.length<=2?u:u.length<=7?`(${u.slice(0,2)}) ${u.slice(2)}`:u.length<=11?`(${u.slice(0,2)}) ${u.slice(2,7)}-${u.slice(7)}`:`(${u.slice(0,2)}) ${u.slice(2,7)}-${u.slice(7,11)}`},j=b=>{const u=E(b.target.value);t({...s,whatsappNumber:u})},z=async b=>{b.preventDefault(),y(!0),v("");try{const u=s.whatsappNumber.replace(/\D/g,"");if(u.length<10){v("Número de WhatsApp inválido"),y(!1);return}await Z(M($,"config","general"),{whatsappNumber:u,companyName:s.companyName,companyEmail:s.companyEmail||"",companyAddress:s.companyAddress||"",updatedAt:new Date().toISOString()}),v("Configurações salvas com sucesso!"),setTimeout(()=>v(""),3e3)}catch(u){console.error("Erro ao salvar configurações:",u),v("Erro ao salvar configurações")}finally{y(!1)}};return A?e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin"})})}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ce,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-xl font-title font-bold",children:"Configurações Gerais"})]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Importante:"})," O número de WhatsApp configurado aqui será usado para receber todos os pedidos do catálogo."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Número do WhatsApp *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:s.whatsappNumber,onChange:j,placeholder:"(00) 00000-0000",className:"w-full pl-11 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Digite apenas números. Ex: 5589994333316"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome da Empresa *"}),e.jsx("input",{type:"text",value:s.companyName,onChange:b=>t({...s,companyName:b.target.value}),placeholder:"Rocha Brindes",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"E-mail da Empresa"}),e.jsx("input",{type:"email",value:s.companyEmail,onChange:b=>t({...s,companyEmail:b.target.value}),placeholder:"contato@rochabrindes.com.br",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Endereço da Empresa"}),e.jsx("textarea",{value:s.companyAddress,onChange:b=>t({...s,companyAddress:b.target.value}),placeholder:"Rua Exemplo, 123 - Bairro - Cidade - Estado",rows:3,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),k&&e.jsx("div",{className:`p-4 rounded-lg text-center font-semibold ${k.includes("sucesso")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:k}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 px-6 rounded-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{size:20}),"Salvar Configurações"]})})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Prévia do número configurado:"}),e.jsx("p",{className:"text-lg font-mono text-primary",children:s.whatsappNumber||"(Nenhum número configurado)"}),s.whatsappNumber&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Link: https://wa.me/",s.whatsappNumber.replace(/\D/g,"")]})]})]})}function Ge(){const[s,t]=l.useState("products"),i=async()=>{await je(ve)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-title font-bold",children:"Painel Admin"}),e.jsx("button",{onClick:i,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg",children:"Sair"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex gap-4 mb-6 overflow-x-auto",children:[e.jsx("button",{onClick:()=>t("products"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="products"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Produtos"}),e.jsx("button",{onClick:()=>t("categories"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="categories"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Categorias"}),e.jsx("button",{onClick:()=>t("layout"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="layout"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Layout"}),e.jsx("button",{onClick:()=>t("config"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="config"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Configurações"})]}),s==="products"&&e.jsxs("div",{className:"space-y-8",children:[e.jsx(qe,{}),e.jsx($e,{})]}),s==="categories"&&e.jsx(Re,{}),s==="layout"&&e.jsx(Ue,{}),s==="config"&&e.jsx(Me,{})]})]})}export{Ge as default};

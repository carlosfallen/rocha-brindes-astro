import{q as oe,e as ie,f as ee,b as R,c as ge,j as e,s as J,d as M,h as be,u as le,i as ye,l as ce,k as je,m as pe,g as Z,n as ve,a as Ne}from"./Providers.B5GdymyL.js";import{r as d}from"./index.Ba-IbuDT.js";import{c as B,u as he,o as xe,P as de}from"./image.CELvQ4Py.js";import{X as Y}from"./x.MqBbpCGq.js";import{S as we}from"./search.3rWvPTZx.js";import{T as fe}from"./trash-2.DIXc-isJ.js";import{C as Ce,a as Se}from"./chevron-right.B_BS1Jv0.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=B("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=B("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=B("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=B("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=B("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=B("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=B("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=B("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=B("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=B("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);function ne(){return he({queryKey:["categories"],queryFn:async()=>{const s=oe(ee(R,"categorias"),ie("nome"));return(await ge(s)).docs.map(i=>({id:i.id,...i.data()}))},staleTime:5*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1})}const Ae="iem94FVEkj3Qjv3DsJXpbQ";async function H(s,o){const i=s.name.split(".").pop()?.toLowerCase()||"jpg";let j="";if(o.type==="main"&&o.productId)j=`${o.productId}.${i}`;else if(o.type==="variation"&&o.productId&&o.variation){const k=o.variation.toLowerCase().replace(/\s+/g,"-");j=`${o.productId}-${k}.${i}`}else j=s.name;const S=new File([s],j,{type:s.type}),C=new FormData;C.append("file",S),C.append("metadata",JSON.stringify({folder:o.folder,productId:o.productId,variation:o.variation,type:o.type,filename:j,uploadDate:new Date().toISOString()}));const D=await fetch("https://imagens.bjeslee19.workers.dev/",{method:"POST",body:C}),y=await D.text();let p;try{p=JSON.parse(y)}catch{p=y}if(!D.ok)throw console.error("Upload error RAW:",p),new Error(typeof p=="string"?p:JSON.stringify(p));if(!p||!p.imageId)throw console.error("Upload OK mas sem imageId:",p),new Error("ID da imagem não retornado pelo servidor");return p.imageId}function X(s,o="public"){return s?s.startsWith("http://")||s.startsWith("https://")||s.startsWith("blob:")||s.startsWith("data:")?s:`https://imagedelivery.net/${Ae}/${s}/${o}`:""}async function F(s){if(s&&!(s.startsWith("http://")||s.startsWith("https://"))&&!(s.startsWith("blob:")||s.startsWith("data:")))try{const o=await fetch("https://imagens.bjeslee19.workers.dev/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:s})});if(!o.ok){const i=await o.text();console.error(`Erro ao deletar imagem ${s}:`,i)}}catch(o){console.error(`Erro ao deletar imagem ${s}:`,o)}}async function Pe(s){const o=s.filter(i=>i&&!i.startsWith("http")&&!i.startsWith("blob:")&&!i.startsWith("data:"));if(o.length!==0)try{const i=await fetch("https://imagens.bjeslee19.workers.dev/delete-multiple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageIds:o})});if(!i.ok){const j=await i.text();console.error("Erro ao deletar múltiplas imagens:",j)}}catch(i){console.error("Erro ao deletar múltiplas imagens:",i)}}const De="1t7T-5mU4ET0kjqd8x_sXlEwunwogCBrlqFnYpVaoyvE",Le="AIzaSyAWUmt2UDeXxY1my2ajGU5bAMSjuU0L14o",Ue="produtos!A:Z";function ue(s){return s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().trim()}function _e(s,o){if(!s||!o)return s;const i=new RegExp(`\\s+${o}$`,"i");return s.replace(i,"").trim()}async function qe(s){const o=s.trim();if(!o)return null;const i=o.split("_"),j=i.length>2?i.slice(0,i.length-1).join("_"):o,S=`https://sheets.googleapis.com/v4/spreadsheets/${De}/values/${encodeURIComponent(Ue)}?key=${Le}`,C=await fetch(S);if(!C.ok)throw console.error("Erro ao buscar planilha:",await C.text()),new Error("Não foi possível acessar a planilha do Google Sheets");const y=(await C.json()).values||[];if(!y.length)return null;const[p,...k]=y;console.log("Header da planilha:",p),console.log("Primeira linha de dados:",k[0]);const E=h=>ue(h||""),A=p.findIndex(h=>{const x=E(h);return["ID","CODIGO","CÓDIGO","SKU","COD","CODE"].includes(x)}),v=p.findIndex(h=>{const x=E(h);return["NOME","PRODUTO","DESCRICAO_CURTA","NAME"].includes(x)}),m=p.findIndex(h=>{const x=E(h);return["DESCRICAO","DESCRIÇÃO","DESC","DESCRIPTION"].includes(x)}),P=p.findIndex(h=>{const x=E(h);return["COR","CORES","VARIACAO","VARIACOES","VARIAÇÃO","COLOR"].includes(x)}),L=p.findIndex(h=>{const x=E(h);return["CATEGORIA","CATEGORIAS","GRUPO","CATEGORY"].includes(x)}),I=p.findIndex(h=>{const x=E(h);return["DESTAQUE","HIGHLIGHT","FEATURED"].includes(x)});if(A===-1)throw console.error("Colunas disponíveis:",p.map((h,x)=>`${x}: ${h}`)),new Error(`Coluna de código/SKU não encontrada na planilha. Colunas disponíveis: ${p.join(", ")}`);const n=k.filter(h=>{const x=(h[A]||"").trim();return x?x===j||x.startsWith(j+"_"):!1});if(!n.length)return null;let u="",z="";const q=new Set;let r=!1;const f=[];for(const h of n){const x=v>=0?(h[v]||"").trim():"",V=m>=0?(h[m]||"").trim():"",$=P>=0?(h[P]||"").trim():"",a=L>=0?(h[L]||"").trim():"",t=I>=0?(h[I]||"").trim():"";!u&&x&&(u=$?_e(x,$):x),!z&&V&&(z=V),a&&a.split(",").map(c=>c.trim()).filter(Boolean).forEach(c=>q.add(c)),typeof t=="string"&&["SIM","TRUE","1","YES","S"].includes(ue(t))&&(r=!0),$&&!f.find(c=>c.cor===$)&&f.push({cor:$})}const w=Array.from(q);return{baseSku:j,nome:u||j,descricao:z,categorias:w,destaque:r,variacoes:f}}function Re(){const[s,o]=d.useState(""),[i,j]=d.useState(""),[S,C]=d.useState(""),[D,y]=d.useState(!1),[p,k]=d.useState([]),[E,A]=d.useState(!1),[v,m]=d.useState(null),[P,L]=d.useState(""),[I,n]=d.useState([]),[u,z]=d.useState(""),[q,r]=d.useState(""),[f,w]=d.useState(!1),[h,x]=d.useState(""),[V,$]=d.useState(!1),{data:a=[]}=ne(),t=l=>{const g=l.target.files?.[0];g&&(m(g),L(URL.createObjectURL(g)))},c=()=>{if(u.trim()){const l=u.trim(),g=[...I,{cor:l,image:null,preview:""}];n(g),q||r(l),z("")}},N=(l,g)=>{const O=[...I];O[l].image=g,O[l].preview=URL.createObjectURL(g),n(O)},U=l=>{const g=I[l]?.cor,O=I.filter((_,W)=>W!==l);n(O),r(_=>_&&_===g?O[0]?.cor??"":_)},b=async()=>{const l=i.trim();if(l){$(!0),x("");try{const g=await qe(l);if(!g){x("Nenhum produto encontrado na planilha com esse código.");return}if(j(g.baseSku),g.nome&&o(g.nome),g.descricao&&C(g.descricao),g.categorias?.length&&(k(g.categorias),A(!1)),y(g.destaque),g.variacoes?.length){const O=g.variacoes.map(W=>({cor:W.cor,image:null,preview:""}));n(O);const _=g.variacoes.find(W=>W.cor.toLowerCase().includes("preto"));_?r(_.cor):g.variacoes[0]?r(g.variacoes[0].cor):r("")}else n([]),r("");x("Dados preenchidos a partir da planilha ✅")}catch(g){console.error(g),x("Erro ao buscar dados na planilha.")}finally{$(!1)}}},T=async l=>{if(l.preventDefault(),p.length===0){A(!0),x("Selecione pelo menos uma categoria");return}A(!1),w(!0),x("");try{if(!i.trim())throw new Error("Informe um código/SKU");const g=[],O=[];let _=null;const W={};for(const Q of I){if(!Q.image)continue;const K=await H(Q.image,{folder:`produtos/${i}/variacoes`,productId:i,variation:Q.cor,type:"variation"});O.push({cor:Q.cor,imagem_url:K,thumb_url:K}),g.push(K),W[Q.cor]=K}if(v)_=await H(v,{folder:`produtos/${i}`,productId:i,type:"main"}),g.unshift(_);else if(q&&W[q])_=W[q];else{const Q=Object.keys(W).find(K=>K.toLowerCase().includes("preto"));if(Q)_=W[Q];else{const K=Object.values(W)[0];K&&(_=K)}}if(!_)throw new Error("Envie pelo menos uma imagem (principal ou de alguma variação).");await J(M(ee(R,"produtos"),i),{id:i,nome:s,descricao:S,categorias:p,destaque:D,variacoes:O,imagem_url:_,thumb_url:_,imagens_urls:g,thumbs_urls:g,createdAt:be()}),x("Produto salvo com sucesso!"),o(""),j(""),C(""),y(!1),k([]),A(!1),m(null),L(""),n([]),z(""),r("")}catch(g){console.error(g),x(g instanceof Error?g.message:"Erro ao salvar produto")}finally{w(!1)}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Adicionar Produto"}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:s,onChange:l=>o(l.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:i,onChange:l=>j(l.target.value),onBlur:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0}),e.jsx("button",{type:"button",onClick:b,disabled:V,className:"px-3 py-2 text-sm rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:V?"Buscando...":"Planilha"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:S,onChange:l=>C(l.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold mb-2",children:["Categorias ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:`flex flex-wrap gap-2 p-3 rounded-lg border-2 ${E?"border-red-300 bg-red-50":"border-gray-200"}`,children:a.map(l=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-50 border border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:p.includes(l.nome),onChange:g=>{A(!1),g.target.checked?k(O=>[...O,l.nome]):k(O=>O.filter(_=>_!==l.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:l.nome})]},l.id))}),E&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Selecione pelo menos uma categoria"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:D,onChange:l=>y(l.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal (opcional)"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:P?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:P,alt:"Preview",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",onClick:()=>{m(null),L("")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1",children:e.jsx(Y,{size:16})})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(G,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal (opcional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t,className:"hidden"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:u,onChange:l=>z(l.target.value),onKeyDown:l=>{l.key==="Enter"&&(l.preventDefault(),c())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"}),e.jsx("button",{type:"button",onClick:c,className:"bg-primary hover:opacity-90 text-text-primary px-4 py-2 rounded-lg font-semibold",children:"Adicionar"})]}),I.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Cor principal"}),e.jsxs("select",{value:q,onChange:l=>r(l.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Selecione a cor principal"}),I.map((l,g)=>e.jsx("option",{value:l.cor,children:l.cor},l.cor+g))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Essa cor será usada como principal se você não enviar imagem principal do produto."})]}),e.jsx("div",{className:"space-y-3",children:I.map((l,g)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:l.cor}),l.preview?e.jsx("div",{className:"relative w-24 h-24",children:e.jsx("img",{src:l.preview,alt:l.cor,className:"w-full h-full object-cover rounded"})}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(G,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:O=>{const _=O.target.files?.[0];_&&N(g,_)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>U(g),className:"text-red-500 hover:bg-red-50 p-2 rounded",children:e.jsx(Y,{size:18})})]},g))})]}),h&&e.jsx("p",{className:`text-center font-semibold ${h.includes("sucesso")||h.includes("planilha")?"text-green-600":"text-red-600"}`,children:h}),e.jsx("button",{type:"submit",disabled:f,className:"w-full bg-primary hover:opacity-90 text-text-primary font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:f?"Salvando...":"Salvar Produto"})]})]})}function Oe({product:s,onClose:o}){const[i,j]=d.useState(s.nome||""),[S,C]=d.useState(s.descricao||""),[D,y]=d.useState(s.destaque||!1),[p,k]=d.useState(s.categorias||[]),[E,A]=d.useState(null),[v,m]=d.useState(s.imagem_url?X(s.imagem_url,"thumbnail"):""),[P,L]=d.useState(s.variacoes?.map(a=>({cor:a.cor,image:null,preview:X(a.imagem_url,"thumbnail"),existingUrl:a.imagem_url}))||[]),[I,n]=d.useState(""),[u,z]=d.useState(!1),[q,r]=d.useState(""),{data:f=[]}=ne(),w=a=>{const t=a.target.files?.[0];t&&(A(t),m(URL.createObjectURL(t)))},h=()=>{I.trim()&&(L([...P,{cor:I.trim(),image:null,preview:""}]),n(""))},x=(a,t)=>{const c=[...P];c[a].image=t,c[a].preview=URL.createObjectURL(t),L(c)},V=a=>{L(P.filter((t,c)=>c!==a))},$=async a=>{a.preventDefault(),z(!0),r("");try{let t=s.imagem_url;E&&(t=await H(E,{folder:`produtos/${s.id}`,productId:s.id,type:"main"}),s.imagem_url&&s.imagem_url!==t&&await F(s.imagem_url));const c=[],N=[t],U=s.variacoes?.map(b=>b.imagem_url)||[];for(const b of P)if(b.image){const T=await H(b.image,{folder:`produtos/${s.id}/variacoes`,productId:s.id,variation:b.cor,type:"variation"});if(c.push({cor:b.cor,imagem_url:T,thumb_url:T}),N.push(T),b.existingUrl&&b.existingUrl!==T){const l=U.indexOf(b.existingUrl);l>-1&&U.splice(l,1)}}else if(b.existingUrl){const T=s.variacoes?.find(l=>l.cor===b.cor);if(T){c.push(T),N.push(T.imagem_url);const l=U.indexOf(T.imagem_url);l>-1&&U.splice(l,1)}}for(const b of U)await F(b);await le(M(R,"produtos",s.id),{nome:i,descricao:S,categorias:p,destaque:D,variacoes:c,imagem_url:t,thumb_url:t,imagens_urls:N,thumbs_urls:N}),r("Produto atualizado com sucesso!"),setTimeout(()=>o(),1500)}catch(t){console.error(t),r(t instanceof Error?t.message:"Erro ao atualizar produto")}finally{z(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{className:"text-xl font-title font-bold",children:"Editar Produto"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Y,{size:20})})]}),e.jsxs("form",{onSubmit:$,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:i,onChange:a=>j(a.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsx("input",{type:"text",value:s.id,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:S,onChange:a=>C(a.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Categorias"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(a=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:p.includes(a.nome),onChange:t=>{t.target.checked?k(c=>[...c,a.nome]):k(c=>c.filter(N=>N!==a.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:a.nome})]},a.id))})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:D,onChange:a=>y(a.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:v?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:v,alt:"Preview",className:"w-full h-full object-contain"}),e.jsxs("label",{className:"absolute bottom-2 right-2 bg-primary text-white p-2 rounded-full cursor-pointer hover:opacity-90 shadow-lg transition-opacity",children:[e.jsx(G,{size:16}),e.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"})]})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(G,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal"}),e.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:I,onChange:a=>n(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),h())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"}),e.jsx("button",{type:"button",onClick:h,className:"bg-primary hover:opacity-90 text-white px-4 py-2 rounded-lg font-semibold transition-opacity",children:"Adicionar"})]}),e.jsx("div",{className:"space-y-3",children:P.map((a,t)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:a.cor}),a.preview?e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("img",{src:a.preview,alt:a.cor,className:"w-full h-full object-cover rounded"}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary text-white p-1 rounded cursor-pointer hover:opacity-90 shadow-md transition-opacity",children:[e.jsx(G,{size:12}),e.jsx("input",{type:"file",accept:"image/*",onChange:c=>{const N=c.target.files?.[0];N&&x(t,N)},className:"hidden"})]})]}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx(G,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:c=>{const N=c.target.files?.[0];N&&x(t,N)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>V(t),className:"text-red-500 hover:bg-red-50 p-2 rounded transition-colors",children:e.jsx(Y,{size:18})})]},t))})]}),q&&e.jsx("div",{className:`p-3 rounded-lg text-center font-semibold ${q.includes("sucesso")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:q}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 rounded-lg transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Salvando...":"Salvar Alterações"})]})]})})}function $e(){const[s,o]=d.useState(0),[i,j]=d.useState([]),[S,C]=d.useState(null),[D,y]=d.useState(null),[p,k]=d.useState(""),E=50,A=ye(),v=d.useMemo(()=>{const r=oe(ee(R,"produtos"),ie("createdAt","desc"),ce(E));return s>0&&i[s-1]?oe(ee(R,"produtos"),ie("createdAt","desc"),je(i[s-1]),ce(E)):r},[s,i,E]),{data:m=[],isLoading:P,refetch:L,isFetching:I}=he({queryKey:["admin-products",s,E,i[s-1]?.id],queryFn:async()=>{const f=(await ge(v)).docs;return f.length>0&&j(w=>{const h=[...w];return h[s]=f[f.length-1],h}),f.map(w=>({id:w.id,...w.data()}))},placeholderData:r=>r??[],staleTime:3e4}),n=d.useMemo(()=>{if(!p.trim())return m;const r=p.toLowerCase();return m.filter(f=>f.nome.toLowerCase().includes(r)||f.id.toLowerCase().includes(r))},[m,p]),u=async r=>{if(confirm(`Tem certeza que deseja excluir "${r.nome}"?`)){y(r.id);try{const f=[];r.imagem_url&&f.push(r.imagem_url),r.thumb_url&&r.thumb_url!==r.imagem_url&&f.push(r.thumb_url),r.imagens_urls?.length&&r.imagens_urls.forEach(w=>{f.includes(w)||f.push(w)}),r.thumbs_urls?.length&&r.thumbs_urls.forEach(w=>{f.includes(w)||f.push(w)}),r.variacoes?.length&&r.variacoes.forEach(w=>{w.imagem_url&&!f.includes(w.imagem_url)&&f.push(w.imagem_url),w.thumb_url&&!f.includes(w.thumb_url)&&f.push(w.thumb_url)}),await Pe(f),await pe(M(R,"produtos",r.id)),await A.invalidateQueries({queryKey:["admin-products"]}),await L()}catch(f){console.error("Erro ao deletar produto:",f),alert("Erro ao deletar produto")}finally{y(null)}}},z=r=>{C(r)},q=()=>{C(null),A.invalidateQueries({queryKey:["admin-products"]}),L()};return P&&!m.length?e.jsx("div",{className:"text-center py-8",children:"Carregando produtos..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("h2",{className:"text-xl font-title font-bold",children:["Produtos Cadastrados ",I&&e.jsx("span",{className:"text-sm text-gray-400",children:"(atualizando…)"})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("input",{type:"text",value:p,onChange:r=>k(r.target.value),placeholder:"Buscar por nome ou SKU...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none text-sm"}),e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18})]})]})}),e.jsx("div",{className:"max-h-[600px] overflow-auto divide-y",children:n.map(r=>{const f=r.thumb_url||r.imagem_url||r.imagens_urls?.[0],w=f?xe(f,"thumbnail"):"";return e.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 hover:bg-gray-50",children:[w?e.jsx("img",{src:w,alt:r.nome??"Produto",className:"w-16 h-16 object-contain rounded bg-gray-50"}):e.jsx("div",{className:"w-16 h-16 flex items-center justify-center bg-gray-100 rounded",children:e.jsx("span",{className:"text-xs text-gray-400",children:"Sem img"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:r.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",r.id]}),e.jsx("div",{className:"flex gap-2 mt-1 flex-wrap",children:r.categorias?.map(h=>e.jsx("span",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:h},h))}),r.variacoes&&r.variacoes.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.variacoes.length," variações de cor"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Editar",disabled:D===r.id,children:e.jsx(Ee,{size:18})}),e.jsx("button",{onClick:()=>u(r),className:"p-2 text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Excluir",disabled:D===r.id,children:D===r.id?e.jsx("div",{className:"w-[18px] h-[18px] border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):e.jsx(fe,{size:18})})]})]},r.id)})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>o(r=>Math.max(0,r-1)),disabled:s===0,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:[e.jsx(Ce,{size:18}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",s+1]}),e.jsxs("button",{onClick:()=>o(r=>r+1),disabled:m.length<E,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:["Próximo",e.jsx(Se,{size:18})]})]})]}),S&&e.jsx(Oe,{product:S,onClose:q})]})}function Me(){const[s,o]=d.useState(""),[i,j]=d.useState(!1),[S,C]=d.useState(null),[D,y]=d.useState(""),[p,k]=d.useState(!1),{data:E=[],refetch:A}=ne(),v=n=>{const u=n.target.files?.[0];u&&(C(u),y(URL.createObjectURL(u)))},m=async n=>{n.preventDefault(),k(!0);try{const u=s.toLowerCase().replace(/\s+/g,"-");let z="";S&&(z=await H(S,{folder:"categorias",productId:u,type:"category"})),await J(M(R,"categorias",u),{id:u,nome:s,productCount:0,popular:i,imagePath:z}),o(""),j(!1),C(null),y(""),A()}catch(u){console.error(u),alert("Erro ao criar categoria")}finally{k(!1)}},P=async n=>{if(confirm("Tem certeza? Esta ação não pode ser desfeita."))try{n.imagePath&&await F(n.imagePath),await pe(M(R,"categorias",n.id)),A()}catch(u){console.error(u),alert("Erro ao excluir categoria")}},L=async n=>{try{await le(M(R,"categorias",n.id),{popular:!n.popular}),A()}catch(u){console.error(u),alert("Não foi possível atualizar popular")}},I=async(n,u)=>{try{const z=await H(u,{folder:"categorias",productId:n.id,type:"category"});n.imagePath&&await F(n.imagePath),await le(M(R,"categorias",n.id),{imagePath:z}),A()}catch(z){console.error(z),alert("Não foi possível atualizar a imagem")}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Gerenciar Categorias"}),e.jsxs("form",{onSubmit:m,className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome da categoria"}),e.jsx("input",{type:"text",value:s,onChange:n=>o(n.target.value),placeholder:"Nome da categoria",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem da categoria"}),D?e.jsxs("div",{className:"relative w-full h-24",children:[e.jsx("img",{src:D,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{C(null),y("")},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1",children:e.jsx(Y,{size:14})})]}):e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx(G,{size:16}),e.jsx("span",{className:"text-sm",children:"Selecionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"hidden"})]})]})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:n=>j(n.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Marcar como categoria popular"})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-primary hover:opacity-90 text-text-primary font-semibold px-6 py-3 rounded-lg disabled:opacity-50",children:p?"Criando...":"Criar Categoria"})]}),e.jsx("div",{className:"space-y-2",children:E.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[n.imagePath&&e.jsx("img",{src:xe(n.imagePath,"thumbnail"),alt:n.nome,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:n.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.productCount||0," produtos"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3",children:[e.jsx("button",{onClick:()=>void L(n),className:`px-3 py-1 rounded border text-sm ${n.popular?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300"}`,children:n.popular?"Popular ✓":"Marcar como popular"}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-1 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(G,{size:14}),e.jsx("span",{className:"text-xs",children:"Alterar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:u=>{const z=u.target.files?.[0];z&&I(n,z)},className:"hidden"})]})]})]})]}),e.jsx("button",{onClick:()=>void P(n),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(fe,{size:18})})]},n.id))})]})}function Te(){const[s,o]=d.useState({banners:[],promotions:[],popups:[]}),[i,j]=d.useState([]),[S,C]=d.useState({thumbnailId:"",videoUrl:""}),[D,y]=d.useState(!1),[p,k]=d.useState(null),[E,A]=d.useState("");d.useEffect(()=>{v(),m(),P()},[]);const v=async()=>{try{const a=await Z(M(R,"config","layout"));a.exists()&&o(a.data())}catch(a){console.error("Erro ao carregar assets:",a)}},m=async()=>{try{const a=await Z(M(R,"config","clients"));if(a.exists()){const t=a.data();j(t.clients||[])}}catch(a){console.error("Erro ao carregar clientes:",a)}},P=async()=>{try{const a=await Z(M(R,"config","video"));a.exists()&&C(a.data())}catch(a){console.error("Erro ao carregar vídeo:",a)}},L=async a=>{await J(M(R,"config","layout"),a)},I=async a=>{await J(M(R,"config","clients"),{clients:a})},n=async a=>{await J(M(R,"config","video"),a)},u=(a,t=3e3)=>{A(a),setTimeout(()=>A(""),t)},z=async a=>{y(!0),k("logo");try{const t=await H(a,{folder:"layout",type:"logo"});s.logo&&await F(s.logo);const c={...s,logo:t};await L(c),o(c),u("Logo atualizado com sucesso!")}catch(t){console.error(t),u("Erro ao fazer upload do logo")}finally{y(!1),k(null)}},q=async(a,t,c,N)=>{y(!0),k(t);try{const U=[];for(let b=0;b<a.length;b++){const T=await H(a[b],{folder:c,type:N});U.push(T)}if(t==="clients"){const b=[...i,...U];await I(b),j(b),u("Logos de clientes adicionados com sucesso!")}else{const b={...s,[t]:[...s[t],...U]};await L(b),o(b),u(`${{banners:"Banners",promotions:"Promoções",popups:"Popups",clients:"Clientes"}[t]} adicionados com sucesso!`)}}catch(U){console.error(U),u("Erro ao fazer upload")}finally{y(!1),k(null)}},r=async(a,t)=>{y(!0),k("video");try{const c=await H(a,{folder:"layout/video",type:"banner"});S.thumbnailId&&await F(S.thumbnailId);const N={thumbnailId:c,videoUrl:t};await n(N),C(N),u("Vídeo atualizado com sucesso!")}catch(c){console.error(c),u("Erro ao fazer upload do vídeo")}finally{y(!1),k(null)}},f=async(a,t)=>{try{if(a==="clients"){const c=i[t];await F(c);const N=i.filter((U,b)=>b!==t);await I(N),j(N)}else{const c=s[a][t];await F(c);const N={...s,[a]:s[a].filter((U,b)=>b!==t)};await L(N),o(N)}u("Item removido com sucesso!")}catch(c){console.error(c),u("Erro ao remover item")}},w=async()=>{if(s.logo)try{await F(s.logo);const a={...s,logo:void 0};await L(a),o(a),u("Logo removido com sucesso!")}catch(a){console.error(a),u("Erro ao remover logo")}},h=async()=>{if(S.thumbnailId)try{await F(S.thumbnailId);const a={thumbnailId:"",videoUrl:""};await n(a),C(a),u("Vídeo removido com sucesso!")}catch(a){console.error(a),u("Erro ao remover vídeo")}},x=(a,t,c=!1,N=!1,U)=>e.jsxs("label",{className:`group relative inline-flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-primary/10 to-primary/5 border-2 border-dashed border-primary/30 rounded-xl cursor-pointer hover:border-primary hover:from-primary/20 hover:to-primary/10 transition-all ${N?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-white rounded-lg shadow-sm group-hover:shadow-md transition-shadow",children:N?e.jsx(ke,{size:20,className:"animate-spin text-primary"}):U||e.jsx(G,{size:20,className:"text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:a}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Clique para selecionar ",c?"arquivos":"arquivo"]})]}),e.jsx("input",{type:"file",accept:"image/*",multiple:c,onChange:b=>{b.target.files&&t(b.target.files)},className:"hidden",disabled:D})]}),V=(a,t,c)=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:a.map((N,U)=>e.jsxs("div",{className:`relative ${c} border-2 border-gray-200 rounded-xl overflow-hidden group hover:border-primary transition-colors bg-gray-50`,children:[e.jsx("img",{src:X(N,"thumbnail"),alt:`${t} ${U+1}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:e.jsx("button",{onClick:()=>void f(t,U),className:"opacity-0 group-hover:opacity-100 bg-red-500 hover:bg-red-600 text-white rounded-full p-3 transition-all shadow-lg transform scale-75 group-hover:scale-100",title:"Remover",children:e.jsx(Y,{size:20})})})]},`${N}-${U}`))}),$=(a,t)=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm",children:a}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:t})]});return e.jsxs("div",{className:"space-y-8",children:[E&&e.jsx("div",{className:`p-4 rounded-xl text-center font-semibold shadow-md animate-fade-in ${E.includes("sucesso")?"bg-green-50 text-green-700 border-2 border-green-200":"bg-red-50 text-red-700 border-2 border-red-200"}`,children:E}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(me,{size:20,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Logo Principal"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Logotipo exibido no cabeçalho do site"})]})]}),s.logo?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-64 h-32 border-2 border-gray-200 rounded-xl p-4 group hover:border-primary transition-colors bg-gray-50",children:e.jsx("img",{src:X(s.logo,"thumbnail"),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsx("button",{onClick:()=>void w(),className:"absolute -top-3 -right-3 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition-all transform hover:scale-110",title:"Remover logo",children:e.jsx(Y,{size:18})})]}):x("Adicionar Logo",a=>void z(a[0]),!1,p==="logo",e.jsx(me,{size:20,className:"text-primary"}))]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e.jsx(ae,{size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Banners Hero"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Slides principais da página inicial"})]})]}),e.jsx("div",{className:"mb-6",children:x("Adicionar Banners",a=>void q(a,"banners","layout/banners","banner"),!0,p==="banners",e.jsx(ae,{size:20,className:"text-primary"}))}),s.banners.length>0?V(s.banners,"banners","aspect-video"):$(e.jsx(ae,{size:28,className:"text-gray-400"}),"Nenhum banner adicionado")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/10 rounded-lg flex items-center justify-center",children:e.jsx(re,{size:20,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Promoções em Destaque"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Cards de ofertas e promoções especiais"})]})]}),e.jsx("div",{className:"mb-6",children:x("Adicionar Promoções",a=>void q(a,"promotions","layout/promocoes","promotion"),!0,p==="promotions",e.jsx(re,{size:20,className:"text-primary"}))}),s.promotions.length>0?V(s.promotions,"promotions","aspect-square"):$(e.jsx(re,{size:28,className:"text-gray-400"}),"Nenhuma promoção adicionada")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/10 rounded-lg flex items-center justify-center",children:e.jsx(se,{size:20,className:"text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Popups"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Modais promocionais exibidos aos visitantes"})]})]}),e.jsx("div",{className:"mb-6",children:x("Adicionar Popups",a=>void q(a,"popups","layout/popups","popup"),!0,p==="popups",e.jsx(se,{size:20,className:"text-primary"}))}),s.popups.length>0?V(s.popups,"popups","aspect-square"):$(e.jsx(se,{size:28,className:"text-gray-400"}),"Nenhum popup adicionado")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500/10 rounded-lg flex items-center justify-center",children:e.jsx(te,{size:20,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Logos de Clientes"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Logos de empresas parceiras"})]})]}),e.jsx("div",{className:"mb-6",children:x("Adicionar Logos de Clientes",a=>void q(a,"clients","layout/clientes","logo"),!0,p==="clients",e.jsx(te,{size:20,className:"text-primary"}))}),i.length>0?V(i,"clients","aspect-square"):$(e.jsx(te,{size:28,className:"text-gray-400"}),"Nenhum logo de cliente adicionado")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-red-500/10 rounded-lg flex items-center justify-center",children:e.jsx(ze,{size:20,className:"text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Vídeo de Produção"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Thumbnail e link do vídeo institucional"})]})]}),S.thumbnailId?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-full max-w-md aspect-video border-2 border-gray-200 rounded-xl overflow-hidden group hover:border-primary transition-colors",children:e.jsx("img",{src:X(S.thumbnailId,"public"),alt:"Thumbnail do vídeo",className:"w-full h-full object-cover"})}),e.jsx("button",{onClick:()=>void h(),className:"absolute -top-3 -right-3 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition-all transform hover:scale-110",title:"Remover vídeo",children:e.jsx(Y,{size:18})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"URL do Vídeo (YouTube, Vimeo, etc.)"}),e.jsx("input",{type:"url",value:S.videoUrl||"",onChange:a=>{const t={...S,videoUrl:a.target.value};C(t)},onBlur:()=>void n(S),placeholder:"https://www.youtube.com/embed/...",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"})]})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold mb-2 block",children:"Thumbnail do Vídeo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a=>{const t=a.target.files?.[0];if(t){const c=prompt("Digite a URL do vídeo (YouTube embed, Vimeo, etc.):");c&&r(t,c)}},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary-dark"})]})})]})]})}function Ve(){const[s,o]=d.useState({whatsappNumber:"",companyName:"",companyEmail:"",companyAddress:""}),[i,j]=d.useState(!1),[S,C]=d.useState(!0),[D,y]=d.useState("");d.useEffect(()=>{p()},[]);const p=async()=>{C(!0);try{const v=await Z(M(R,"config","general"));if(v.exists()){const m=v.data(),P=m.whatsappNumber?.replace(/\D/g,"")||"",L=P.startsWith("55")?P.slice(2):P,I=k(L);o({whatsappNumber:I,companyName:m.companyName||"",companyEmail:m.companyEmail||"",companyAddress:m.companyAddress||""})}}catch(v){console.error("Erro ao carregar configurações:",v),y("Erro ao carregar configurações")}finally{C(!1)}},k=v=>{const m=v.replace(/\D/g,"");return m.length<=2?m:m.length<=7?`(${m.slice(0,2)}) ${m.slice(2)}`:m.length<=11?`(${m.slice(0,2)}) ${m.slice(2,7)}-${m.slice(7)}`:`(${m.slice(0,2)}) ${m.slice(2,7)}-${m.slice(7,11)}`},E=v=>{const m=k(v.target.value);o({...s,whatsappNumber:m})},A=async v=>{v.preventDefault(),j(!0),y("");try{let m=s.whatsappNumber.replace(/\D/g,"");if(m.length<10||m.length>11){y("Número de WhatsApp inválido"),j(!1);return}const P=`55${m}`;await J(M(R,"config","general"),{whatsappNumber:P,companyName:s.companyName,companyEmail:s.companyEmail||"",companyAddress:s.companyAddress||"",updatedAt:new Date().toISOString()}),y("Configurações salvas com sucesso!"),setTimeout(()=>y(""),3e3)}catch(m){console.error("Erro ao salvar configurações:",m),y("Erro ao salvar configurações")}finally{j(!1)}};return S?e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin"})})}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(de,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-xl font-title font-bold",children:"Configurações Gerais"})]}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Importante:"})," O número de WhatsApp configurado aqui será usado para receber todos os pedidos do catálogo."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Número do WhatsApp *"}),e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:s.whatsappNumber,onChange:E,placeholder:"(00) 00000-0000",className:"w-full pl-11 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Digite apenas números. Ex: 5589994333316"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome da Empresa *"}),e.jsx("input",{type:"text",value:s.companyName,onChange:v=>o({...s,companyName:v.target.value}),placeholder:"Rocha Brindes",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"E-mail da Empresa"}),e.jsx("input",{type:"email",value:s.companyEmail,onChange:v=>o({...s,companyEmail:v.target.value}),placeholder:"contato@rochabrindes.com.br",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Endereço da Empresa"}),e.jsx("textarea",{value:s.companyAddress,onChange:v=>o({...s,companyAddress:v.target.value}),placeholder:"Rua Exemplo, 123 - Bairro - Cidade - Estado",rows:3,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),D&&e.jsx("div",{className:`p-4 rounded-lg text-center font-semibold ${D.includes("sucesso")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:D}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 px-6 rounded-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{size:20}),"Salvar Configurações"]})})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Prévia do número configurado:"}),e.jsx("p",{className:"text-lg font-mono text-primary",children:s.whatsappNumber||"(Nenhum número configurado)"}),s.whatsappNumber&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Link: https://wa.me/",s.whatsappNumber.replace(/\D/g,"")]})]})]})}function Ye(){const[s,o]=d.useState("products"),i=async()=>{await ve(Ne)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-title font-bold",children:"Painel Admin"}),e.jsx("button",{onClick:i,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg",children:"Sair"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex gap-4 mb-6 overflow-x-auto",children:[e.jsx("button",{onClick:()=>o("products"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="products"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Produtos"}),e.jsx("button",{onClick:()=>o("categories"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="categories"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Categorias"}),e.jsx("button",{onClick:()=>o("layout"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="layout"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Layout"}),e.jsx("button",{onClick:()=>o("config"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="config"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Configurações"})]}),s==="products"&&e.jsxs("div",{className:"space-y-8",children:[e.jsx(Re,{}),e.jsx($e,{})]}),s==="categories"&&e.jsx(Me,{}),s==="layout"&&e.jsx(Te,{}),s==="config"&&e.jsx(Ve,{})]})]})}export{Ye as default};
